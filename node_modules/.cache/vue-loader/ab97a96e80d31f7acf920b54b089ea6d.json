{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\patientManagement\\unassignedrecord\\components\\newEdit.vue?vue&type=style&index=0&id=146d7b37&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\patientManagement\\unassignedrecord\\components\\newEdit.vue","mtime":1678931188673},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\css-loader\\dist\\cjs.js","mtime":1678931311747},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1678931317953},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\postcss-loader\\src\\index.js","mtime":1678931314216},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1678931310798},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678931310818},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js","mtime":1678931316857}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouZWwtcm93IHsNCiAgbWFyZ2luOiAxcHggMDsNCn0NCg0KLmNvbnRlbnRib3ggew0KICBoZWlnaHQ6IDYwMHB4Ow0KfQ0KDQouZWwtY29sbmFtZSB7DQogIG1hcmdpbi1sZWZ0OiA2MHB4Ow0KfQ0KDQouaGVhZGluZ3N0eWxlcyB7DQogIGxpbmUtaGVpZ2h0OiAyNXB4Ow0KfQ0K"},{"version":3,"sources":["newEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAy3BA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"newEdit.vue","sourceRoot":"src/views/patientManagement/unassignedrecord/components","sourcesContent":["<template>\r\n  <el-dialog :title=\"title\" :visible.sync=\"dialogVisible\" :close-on-click-modal=\"false\" width=\"80%\" top=\"20px\" @close=\"close\">\r\n    <div slot=\"title\" class=\"dialog-title\">\r\n      <div class=\"sectionstly\"></div>\r\n      <span class=\"title-text\">{{ title }}</span>\r\n      <div class=\"button-right\">\r\n        <span class=\"title-close\" @click=\"close\"></span>\r\n      </div>\r\n    </div>\r\n    <div class=\"contentbox\">\r\n      <!-- <span class=\"headingstyles\"></span> -->\r\n      <div class=\"detailstitlo\">\r\n        <p class=\"xqtitolstyle\">基础信息</p>\r\n      </div>\r\n      <el-form class=\"form_row\" ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"150px\">\r\n        <el-row>\r\n          <el-col :span=\"6\">\r\n            <el-form-item label=\"姓名: \">\r\n              <el-input v-model=\"form.Name\" disabled placeholder=\"患者姓名\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"2\">\r\n            <el-button style=\"margin-left: 10px\" type=\"primary\" v-if=\"!Isdisabled\" @click=\"clickpatientselect\">选择</el-button>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"证件号: \">\r\n              <el-input v-model=\"form.CardNo\" disabled placeholder=\"请输入内容\" @input=\"idCardNoChange\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"手机号: \">\r\n              <el-input v-model=\"form.Phone\" disabled placeholder=\"请输入内容\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <div class=\"detailstitlo\">\r\n          <p class=\"xqtitolstyle\">确诊信息</p>\r\n        </div>\r\n        <el-row>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"结核病类型: \">\r\n              <el-select v-model=\"form.DiagnosisType\" placeholder=\"请输入内容\">\r\n                <el-option v-for=\"item in A0013\" :key=\"item.DetailsCode\" :label=\"item.DetailsName\" :value=\"item.DetailsCode\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"患者类型: \" prop=\"PatientType\">\r\n              <el-select v-model=\"form.PatientType\" placeholder=\"请输入内容\">\r\n                <el-option v-for=\"item in A0014\" :key=\"item.DetailsCode\" :label=\"item.DetailsName\" :value=\"item.DetailsCode\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"痰菌情况: \" prop=\"Sputum\">\r\n              <el-select v-model=\"form.Sputum\" placeholder=\"请输入内容\">\r\n                <el-option v-for=\"item in A0015\" :key=\"item.DetailsCode\" :label=\"item.DetailsName\" :value=\"item.DetailsCode\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"确诊日期: \" prop=\"DiagnosisTime\">\r\n              <el-date-picker align=\"center\" v-model=\"form.DiagnosisTime\" type=\"date\" placeholder=\"选择日期\"></el-date-picker>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"病例类型: \" prop=\"DetectionPathway\">\r\n              <el-select v-model=\"form.DetectionPathway\" placeholder=\"请输入内容\">\r\n                <el-option v-for=\"item in A0016\" :key=\"item.DetailsCode\" :label=\"item.DetailsName\" :value=\"item.DetailsCode\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"是否耐药: \" prop=\"IsDrugResistance\">\r\n              <el-select v-model=\"form.IsDrugResistance\" placeholder=\"请输入内容\">\r\n                <el-option v-for=\"item in A0024\" :key=\"item.DetailsCode\" :label=\"item.DetailsName\" :value=\"item.DetailsCode\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"分子生物学检测: \" prop=\"MolecularBiologyResult\">\r\n              <el-select v-model=\"form.MolecularBiologyResult\" placeholder=\"请输入内容\">\r\n                <el-option v-for=\"item in A0040\" :key=\"item.DetailsCode\" :label=\"item.DetailsName\" :value=\"item.DetailsCode\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"胸片: \" prop=\"ChestRadiographyResult\">\r\n              <el-select v-model=\"form.ChestRadiographyResult\" placeholder=\"请输入内容\">\r\n                <el-option v-for=\"item in A0041\" :key=\"item.DetailsCode\" :label=\"item.DetailsName\" :value=\"item.DetailsCode\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"肝功能: \" prop=\"LiverFunctionResult\">\r\n              <el-select v-model=\"form.LiverFunctionResult\" placeholder=\"请输入内容\">\r\n                <el-option v-for=\"item in A0041\" :key=\"item.DetailsCode\" :label=\"item.DetailsName\" :value=\"item.DetailsCode\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"确诊机构: \" prop=\"DiagnosisOrganizationId\">\r\n              <el-select filterable v-model=\"form.DiagnosisOrganizationId\">\r\n                <el-option\r\n                  v-for=\"item in DiagnosisOrganizationIdlist\"\r\n                  :key=\"item.index\"\r\n                  :label=\"item.OrganizationName\"\r\n                  :value=\"item.OrganizationId\"\r\n                ></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"发现方式: \" prop=\"LiverFunctionResult\">\r\n              <el-select v-model=\"form.DiscoveryMode\" placeholder=\"请输入内容\">\r\n                <el-option v-for=\"item in A0039\" :key=\"item.DetailsCode\" :label=\"item.DetailsName\" :value=\"item.DetailsCode\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"首管理单位: \" prop=\"FirstAdminOrganization\">\r\n              <el-select filterable v-model=\"form.FirstAdminOrganization\">\r\n                <el-option\r\n                  v-for=\"item in ShouAdminOrganizationlist\"\r\n                  :key=\"item.index\"\r\n                  :label=\"item.OrganizationName\"\r\n                  :value=\"item.OrganizationId\"\r\n                ></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"现管理单位: \" prop=\"XianAdminOrganization\">\r\n              <el-select filterable v-model=\"form.XianAdminOrganization\" @change=\"selectOrganizationName\">\r\n                <el-option\r\n                  v-for=\"item in XianAdminOrganizationlist\"\r\n                  :key=\"item.index\"\r\n                  :label=\"item.OrganizationName\"\r\n                  :value=\"item.OrganizationId\"\r\n                ></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"服药单位: \" prop=\"MedicineAdminOrganization\">\r\n              <el-select filterable v-model=\"form.MedicineAdminOrganization\" @change=\"selectMedicineAdminOrganization\">\r\n                <el-option\r\n                  v-for=\"item in MedicineAdminOrganizationlist\"\r\n                  :key=\"item.index\"\r\n                  :label=\"item.OrganizationName\"\r\n                  :value=\"item.OrganizationId\"\r\n                ></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"督导单位: \" prop=\"AdminOrganization\">\r\n              <el-select filterable v-model=\"form.AdminOrganization\" @change=\"changeOrg\">\r\n                <el-option\r\n                  v-for=\"item in AdminOrganizationlist\"\r\n                  :key=\"item.index\"\r\n                  :label=\"item.OrganizationName\"\r\n                  :value=\"item.OrganizationId\"\r\n                ></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"责任医师: \" prop=\"Responsibility\">\r\n              <el-select filterable v-model=\"form.Responsibility\">\r\n                <el-option v-for=\"item in options\" :key=\"item.index\" :label=\"item.label\" :value=\"item.value\"></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"登记号: \">\r\n              <el-input v-model=\"form.RegistrationNo\" placeholder=\"请输入登记号\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"开始治疗日期 : \" prop=\"TreatmentStartDate\">\r\n              <el-date-picker align=\"center\" v-model=\"form.TreatmentStartDate\" type=\"date\" placeholder=\"选择日期\"></el-date-picker>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"登记时间: \">\r\n              <el-date-picker align=\"center\" v-model=\"form.RegisterTime\" disabled type=\"date\" placeholder=\"选择日期时间\"></el-date-picker>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"结核病治疗卡编号: \" prop=\"FileNumber\">\r\n              <el-input v-model=\"form.FileNumber\" disabled placeholder=\"请输入结核病治疗卡编号\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"8\">\r\n            <el-form-item label=\"治疗方案\" prop=\"TreatmentPlanId\">\r\n              <el-select v-model=\"form.TreatmentPlanId\" placeholder=\"请输入内容\" @blur=\"chanceTreatmentPlanId\">\r\n                <el-option\r\n                  v-for=\"item in TreatmentPlanId\"\r\n                  :key=\"item.TreatmentPlanId\"\r\n                  :label=\"item.TreatmentPlanName\"\r\n                  :value=\"item.TreatmentPlanId\"\r\n                ></el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-button style=\"margin-left: 30px\" type=\"primary\" @click=\"handlerEdit\">新增治疗方案</el-button>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"4\" class=\"el-colname\">\r\n            <label>强化期(月):</label>\r\n            <span>{{ StrengtheningPeriodMonth }}</span>\r\n          </el-col>\r\n          <el-col :span=\"6\">\r\n            <label>强化期服药频率(次/天):</label>\r\n            <span>{{ StrengtheningPeriodDMT }}</span>\r\n          </el-col>\r\n          <el-col :span=\"6\">\r\n            <label>巩固期(月):</label>\r\n            <span>{{ ConsolidationPeriodMonth }}</span>\r\n          </el-col>\r\n          <el-col :span=\"6\">\r\n            <label>巩固期服药频率(次/天):</label>\r\n            <span>{{ ConsolidationPeriodDMT }}</span>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n    </div>\r\n    <div slot=\"footer\">\r\n      <el-button class=\"cancelbtn\" @click=\"close\">取 消</el-button>\r\n      <el-button class=\"savebtn\" type=\"primary\" @click=\"handlerSave\" v-if=\"flag !== 'details'\">确 定</el-button>\r\n    </div>\r\n    <patientSelect ref=\"patientselectlist\" @selectSubmit=\"getSelectRespons\"></patientSelect>\r\n    <OptionsEdit ref=\"optionsedit\" @sumiteprogramme=\"funtreatmentplantemplates\"></OptionsEdit>\r\n  </el-dialog>\r\n</template>\r\n<script>\r\nimport { usedictionarydetails } from '@/api/dict.js'\r\nimport {\r\n  getOrganizationList,\r\n  getorgcascader,\r\n  getuserDrop,\r\n  droporganizations,\r\n} from '@/api/organizationManagement.js';\r\nimport {\r\n  tuberculosisdiagnosiss,\r\n  addtuberculosisdiagnosiss,\r\n  edittuberculosisdiagnosiss,\r\n  deletetuberculosisdiagnosiss,\r\n  tuberculosisdiagnosissexcel,\r\n  generatetreatmentnumber,\r\n  tuberculosisdiagnosissmsg\r\n} from '@/api/TuberculosisDiagnosis.js'\r\nimport {\r\n  pulmonaryclosesvisitandmedicine,\r\n  addapplysettlement,\r\n  pulmonarycloseslist,\r\n  updatatuberculosisModify\r\n} from '@/api/PulmonaryClose.js'\r\nimport OptionsEdit from '../components/tabComponents/echeatComponents/optionsEdit.vue' //./echeatComponents/optionsEdit.vue\r\nimport { treatmentplantemplates } from '@/api/TreatmentPlanTemplate.js'\r\nimport patientSelect from '../components/patientSelect.vue'\r\nexport default {\r\n  components: {\r\n    patientSelect,\r\n    OptionsEdit\r\n  },\r\n  name: \"Edit\",\r\n  data () {\r\n    return {\r\n      title: \"新增治疗卡\",\r\n      Isdisabled: false,\r\n      // 弹窗的开关\r\n      dialogVisible: false,\r\n      flag: \"\",\r\n      StrengtheningPeriodMonth: '',\r\n      StrengtheningPeriodDMT: '',\r\n      ConsolidationPeriodMonth: '',\r\n      ConsolidationPeriodDMT: '',\r\n      form: {\r\n        ContractStaffs: [],\r\n        MedicineAdminOrganization: \"\",\r\n        AdminOrganization: \"\",\r\n        FileNumber: '',\r\n        Name: '',\r\n        RegisterTime: \"\",\r\n      },\r\n      TreatmentPlanId: [],\r\n      ContractStaffList: [],\r\n      tenantData: [], //行政区域\r\n      options: [], //医师\r\n      propslist: {\r\n        value: \"OrganizationId\",\r\n        label: \"OrganizationName\",\r\n        children: \"Children\",\r\n        checkStrictly: true,\r\n        emitPath: false,\r\n        lazy: true,\r\n        lazyLoad: this.lazyLoad\r\n      },\r\n      //  表单验证\r\n      rules: {\r\n        FileNumber: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"blur\"\r\n        },],\r\n        Name: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"blur\"\r\n        },],\r\n        Sex: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"change\"\r\n        },],\r\n        Age: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"blur\"\r\n        },],\r\n        Phone: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"blur\"\r\n        },],\r\n        CardNo: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"blur\"\r\n        },],\r\n        RegistrationNo: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"blur\"\r\n        },],\r\n        TreatmentStartDate: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"blur\"\r\n        },],\r\n        XianAdminOrganization: [{\r\n          required: true,\r\n          message: \"请选择现管理单位\",\r\n          trigger: \"blur\"\r\n        },],\r\n        MedicineAdminOrganization: [{\r\n          required: true,\r\n          message: \"请选择服药单位\",\r\n          trigger: \"blur\"\r\n        },],\r\n        AdminOrganization: [{\r\n          required: true,\r\n          message: \"请选择督导单位\",\r\n          trigger: \"blur\"\r\n        },],\r\n        FirstAdminOrganization: [{\r\n          required: true,\r\n          message: \"请选择首管单位\",\r\n          trigger: \"blur\"\r\n        },],\r\n        ContractStaff: [{\r\n          required: true,\r\n          message: \"请至少选择一项\",\r\n          trigger: \"change\"\r\n        },],\r\n        DiagnosisType: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"change\"\r\n        },],\r\n        PatientType: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"change\"\r\n        },],\r\n        Sputum: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"change\"\r\n        },],\r\n        // DiagnosisOrganizationId: [{\r\n        //   required: true,\r\n        //   message: \"请输入\",\r\n        //   trigger: \"change\"\r\n        // },],\r\n        DiagnosisTime: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"change\"\r\n        },],\r\n        // DetectionPathway: [{\r\n        //   required: true,\r\n        //   message: \"请输入\",\r\n        //   trigger: \"change\"\r\n        // },],\r\n        // IsDrugResistance: [{\r\n        //   required: true,\r\n        //   message: \"请输入\",\r\n        //   trigger: \"change\"\r\n        // },],\r\n        // MolecularBiologyResult: [{\r\n        //   required: true,\r\n        //   message: \"请输入\",\r\n        //   trigger: \"change\"\r\n        // },],\r\n        // ChestRadiographyResult: [{\r\n        //   required: true,\r\n        //   message: \"请输入\",\r\n        //   trigger: \"change\"\r\n        // },],\r\n        // LiverFunctionResult: [{\r\n        //   required: true,\r\n        //   message: \"请选择\",\r\n        //   trigger: \"blur\"\r\n        // },],\r\n        Responsibility: [{\r\n          required: true,\r\n          message: \"请选择\",\r\n          trigger: \"blur\"\r\n        },],\r\n        RegisterTime: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"change\"\r\n        },],\r\n        TreatmentPlanId: [{\r\n          required: true,\r\n          message: \"请输入\",\r\n          trigger: \"change\"\r\n        },],\r\n      },\r\n      A0003: [],\r\n      A0013: [],\r\n      A0014: [],\r\n      A0015: [],\r\n      A0016: [],\r\n      A0017: [],\r\n      A0021: [],\r\n      A0001: [],\r\n      A0039: [],\r\n      A0040: [],\r\n      A0041: [],\r\n      A0024: [],\r\n      dictarr: [],\r\n      XianAdminOrganizationlist: [], //现管机构\r\n      ShouAdminOrganizationlist: [],//首管理单位\r\n      MedicineAdminOrganizationlist: [], //服药单位\r\n      AdminOrganizationlist: [], //督导机构\r\n      DiagnosisOrganizationIdlist: [], //确诊机构\r\n      paParams: {\r\n        PageNumber: 1,\r\n        PageSize: 60,\r\n      },\r\n      copyform: {},\r\n\r\n    };\r\n  },\r\n  async created () {\r\n    // 字典\r\n    await this.funusedictionarydetails()\r\n    this.fundictlist()\r\n    await this.funtreatmentplantemplates()\r\n    await this.usedictionarydetails()\r\n    await this.getorganizationlist() //获取机构列表\r\n    // await this.getuserDropList() //根据机构获取用户下拉列表\r\n    // this.form.RegisterTime = \r\n  },\r\n  methods: {\r\n    //选择现管理单位\r\n    selectOrganizationName () {\r\n      this.form.MedicineAdminOrganization = '';\r\n      this.form.AdminOrganization = '';\r\n      this.getMedicineAdminOrganizationlist() //服药单位列表\r\n    },\r\n    //获取服药单位列表 \r\n    async getMedicineAdminOrganizationlist () {\r\n      if (this.form.XianAdminOrganization) {\r\n        const res = await droporganizations({\r\n          OrganizationId: this.form.XianAdminOrganization,\r\n          SelectOnly: false,\r\n          PageSize: 9999\r\n        });\r\n        this.MedicineAdminOrganizationlist = res.Response;\r\n      }\r\n    },\r\n    //获取督导机构列表 \r\n    async getAdminOrganizationlist () {\r\n      if (this.form.MedicineAdminOrganization) {\r\n        const res = await droporganizations({\r\n          OrganizationId: this.form.MedicineAdminOrganization,\r\n          SelectOnly: false,\r\n          PageSize: 9999\r\n        });\r\n        this.AdminOrganizationlist = res.Response;\r\n\r\n      }\r\n    },\r\n    //选择服药单位\r\n    selectMedicineAdminOrganization () {\r\n      this.form.AdminOrganization = '';\r\n      this.getAdminOrganizationlist() //督导单位列表\r\n    },\r\n    //根据主键获取全部信息\r\n    async pulmonarycloseslistmsg (data) {\r\n      const res = await tuberculosisdiagnosissmsg(data.DiagnosisId)\r\n      this.form = {\r\n        ...res.Response\r\n      }\r\n      await this.getuserDropList() //根据机构获取用户下拉列表\r\n      this.copyform = {\r\n        ...res.Response\r\n      }\r\n    },\r\n    //加载所有机构\r\n    async allorganizationslist () {\r\n      const res = await droporganizations({\r\n        IsAppoinOrganization: true\r\n      })\r\n      this.DiagnosisOrganizationIdlist = res.Response;\r\n      const res2 = await droporganizations({\r\n        IsCDC: true\r\n      })\r\n      this.ShouAdminOrganizationlist = res2.Response;\r\n      const res3 = await droporganizations({\r\n        OrganizationId: this.$utilsFun.getUserInfo().authOrgId,\r\n        SelectOnly: false,\r\n        IsCDC: true,\r\n      })\r\n      this.XianAdminOrganizationlist = res3.Response;\r\n    },\r\n    // 确认新增？修改\r\n    async show (flag, data) {\r\n      this.dialogVisible = true;\r\n      this.flag = flag;\r\n      if (flag == \"add\") {\r\n        this.title = \"新增病案\";\r\n        this.Isdisabled = false;\r\n        this.form.OperatorNameFirst = this.$utilsFun.getUserInfo().real_Name //给建档人默认当前人\r\n        var datetime = new Date();\r\n        var year = datetime.getFullYear(); //获取完整的年份(4位,如:1970)\r\n        var month = datetime.getMonth() + 1; //获取月份(返回0-11,0代表1月,用的时候记得加上1)\r\n        var date = datetime.getDate(); //获取日(返回1-31)\r\n        //判断小于等于9月的时候在月份前加一个\"0\"\r\n        if (month <= 9) {\r\n          month = \"0\" + month;\r\n        }\r\n        //判断小于等于9号的时候在天数前加一个\"0\"\r\n        if (date <= 9) {\r\n          date = \"0\" + date;\r\n        }\r\n        this.form.OperateTimeFirst = year + \"-\" + month + \"-\" + date; //给建档时间默认当前\r\n        this.form.RegisterTime = year + \"-\" + month + \"-\" + date;\r\n        this.StrengtheningPeriodDMT = '';\r\n        this.ConsolidationPeriodMonth = '';\r\n        this.ConsolidationPeriodDMT = '';\r\n        this.StrengtheningPeriodMonth = '';\r\n        this.getarchivesnum() //获取档案编号\r\n        this.getorganizationlist() //获取机构列表\r\n        this.allorganizationslist() //所有机构列表\r\n      } else if (flag == \"edit\") {\r\n        this.title = \"编辑\";\r\n        this.Isdisabled = true;\r\n        await this.pulmonarycloseslistmsg(data)\r\n        await this.allorganizationslist() //所有机构列表\r\n        await this.getorganizationlist() //获取机构列表\r\n        await this.getMedicineAdminOrganizationlist() //服药单位列表\r\n        await this.getAdminOrganizationlist()//督导机构列表\r\n      }else if (flag == \"details\") {\r\n        this.title = \"详情\";\r\n        this.Isdisabled = true;\r\n        await this.pulmonarycloseslistmsg(data)\r\n        await this.allorganizationslist() //所有机构列表\r\n        await this.getorganizationlist() //获取机构列表\r\n        await this.getMedicineAdminOrganizationlist() //服药单位列表\r\n        await this.getAdminOrganizationlist()//督导机构列表\r\n      } else if (flag == 'recurrence') {\r\n        this.title = \"复发\";\r\n        this.Isdisabled = true;\r\n        await this.pulmonarycloseslistmsg(data)\r\n        await this.getarchivesnum() //获取档案编号\r\n        await this.allorganizationslist() //所有机构列表\r\n        await this.getorganizationlist() //获取机构列表\r\n        await this.getMedicineAdminOrganizationlist() //服药单位列表\r\n        await this.getAdminOrganizationlist()//督导机构列表\r\n        this.form.PatientType = '2' //复治\r\n        var datetime = new Date();\r\n        var year = datetime.getFullYear(); //获取完整的年份(4位,如:1970)\r\n        var month = datetime.getMonth() + 1; //获取月份(返回0-11,0代表1月,用的时候记得加上1)\r\n        var date = datetime.getDate(); //获取日(返回1-31)\r\n        //判断小于等于9月的时候在月份前加一个\"0\"\r\n        if (month <= 9) {\r\n          month = \"0\" + month;\r\n        }\r\n        //判断小于等于9号的时候在天数前加一个\"0\"\r\n        if (date <= 9) {\r\n          date = \"0\" + date;\r\n        }\r\n        this.form.RegisterTime = year + \"-\" + month + \"-\" + date;\r\n      }\r\n    },\r\n    //获取档案编号\r\n    async getarchivesnum () {\r\n      const res = await generatetreatmentnumber();\r\n      this.form.FileNumber = res;\r\n    },\r\n    //人群属性\r\n    async usedictionarydetails (params) {\r\n      const res = await usedictionarydetails({\r\n        CategoryCode: 'A0021'\r\n      })\r\n      this.ContractStaffList = res.Response.items\r\n    },\r\n    //获取机构列表\r\n    async getorganizationlist () {\r\n      // this.form.DiagnosisOrganizationId = this.$utilsFun.getUserInfo().authOrgId; //this.$utilsFun.getUserInfo().authOrgId'360111000'\r\n      const res = await getorgcascader(this.form.DiagnosisOrganizationId);\r\n      // for(let i in res.Response){\r\n      // \tres.Response[i]['label']=res.Response[i].OrganizationName\r\n      // \tres.Response[i]['value']=res.Response[i].OrganizationId\r\n      // }\r\n      this.tenantData = res.Response;\r\n    },\r\n    //获取确诊机构列表\r\n    async getDiagnosisOrganizationIdlist () {\r\n      const res = await getOrganizationList({\r\n        // IsAppoinOrganization: true,\r\n        PageSize: 9999\r\n        // IsCDC: true,\r\n      });\r\n      this.DiagnosisOrganizationIdlist = res.Response.items;\r\n      this.XianAdminOrganizationlist = res.Response.items;\r\n      this.MedicineAdminOrganizationlist = res.Response.items;\r\n      this.AdminOrganizationlist = res.Response.items;\r\n    },\r\n    //医师下拉框\r\n    async getuserDropList () {\r\n      var organizationId = this.form.AdminOrganization;\r\n      var selectOnly = true;\r\n      const res = await getuserDrop(organizationId, selectOnly);\r\n      this.options = []; //下拉列表\r\n      if (res.Response.length !== 0) {\r\n        if (res.Response.length == 1) {\r\n          this.form.Responsibility = res.Response[0].Id;\r\n\r\n        }\r\n        for (let item of res.Response) {\r\n          this.options.push({\r\n            label: item.Name,\r\n            value: item.Id,\r\n          });\r\n        }\r\n      }\r\n    },\r\n    async lazyLoad (node, resolve) {\r\n      let {\r\n        level\r\n      } = node;\r\n      let params = node.value\r\n      getOrganizationList({\r\n        Org_OrganizationId: params,\r\n        PageNumber: 1,\r\n        PageSize: 9999,\r\n      }).then(res => { //接口\r\n        if (res && res.StatusCode == 200) {\r\n          let data = [res.Response]\r\n          if (level > 0) {\r\n            data = res.Response.items\r\n          }\r\n          resolve(data);\r\n        } else {\r\n          this.$message.error('获取地区数据失败')\r\n        }\r\n      })\r\n    },\r\n    chanceXianAdminOrganization () {\r\n    },\r\n    //新增治疗方案\r\n    handlerEdit (flag, data) {\r\n      data = this.TreatmentPlanId;\r\n      this.$refs.optionsedit.show(flag, data)\r\n    },\r\n    //选择行政区域\r\n    changeOrg (value) {\r\n      this.form.AdminOrganization = value;\r\n      this.options = [];\r\n      this.form.Responsibility = '';\r\n      this.getuserDropList()\r\n    },\r\n    // 保存\r\n    handlerSave () {\r\n      this.$refs[\"form\"].validate((valid) => {\r\n        if (!valid) return;\r\n        this.hasinfo = [];\r\n        for (let key in this.form) {\r\n          let obj = {};\r\n          if (this.form[key] !== this.copyform[key]) {\r\n            obj.op = 'replace',\r\n              obj.value = this.form[key];\r\n            obj.path = key;\r\n            this.hasinfo.push(obj)\r\n          }\r\n        }\r\n        this.$baseConfirm(`确认要${this.title}此项目吗？`, null, async () => {\r\n          let subData = Object.assign({}, this.form)\r\n          if (this.flag == 'add') {\r\n            const res = await addtuberculosisdiagnosiss(subData)\r\n            this.$emit(\"sumite\")\r\n            this.$baseMessage('操作成功', \"success\")\r\n            // this.$emit(\"newedit\", this.flag, subData);\r\n            this.close();\r\n          } else if (this.flag == 'edit') {\r\n            const DiagnosisId = subData.DiagnosisId\r\n            const res = await edittuberculosisdiagnosiss(DiagnosisId, this.hasinfo)\r\n            let {\r\n              StatusCode,\r\n              Message\r\n            } = res;\r\n            if (StatusCode != 200) {\r\n              return this.$baseMessage(\r\n                Message || '修改失败', 'error'\r\n              )\r\n            } else {\r\n              this.$baseMessage('修改成功', \"success\")\r\n              this.$emit(\"sumite\")\r\n              this.close();\r\n            }\r\n          } else if (this.flag == 'recurrence') {\r\n            const res = await addtuberculosisdiagnosiss({\r\n              ...this.Personform,\r\n              ...this.form,\r\n            })\r\n            this.$emit('sumite');\r\n            this.close();\r\n            this.$baseMessage('操作成功', \"success\")\r\n            this.$router.push('/patientManagement/patientManagement/index')\r\n          }\r\n        });\r\n      });\r\n    },\r\n    close () {\r\n      this.dialogVisible = false;\r\n      // 重置数据(封装的方法)\r\n      this.form = this.$options.data().form;\r\n      this.$refs[\"form\"].resetFields();\r\n    },\r\n    //治疗方案下拉\r\n    chanceTreatmentPlanId (val) {\r\n    },\r\n    idCardNoChange () {\r\n      const IdNmber = this.form.CardNo\r\n      const sex = IdNmber.slice(16, 17)\r\n      const myDate = new Date();\r\n      const month = myDate.getMonth() + 1;\r\n      const day = myDate.getDate();\r\n      //出生日期\r\n      this.form.BirthDay = IdNmber.slice(6, 10) + '-' + IdNmber.slice(10, 12) + '-' + IdNmber.slice(12, 14)\r\n      // 年龄\r\n      if (IdNmber.slice(6, 14).length == 8) {\r\n        this.form.Age = myDate.getFullYear() - IdNmber.slice(6, 10) - 1\r\n        if (IdNmber.slice(10, 12) < month || IdNmber.slice(10, 12) == month && IdNmber.slice(12, 14) <= day) {\r\n          this.form.Age++\r\n        }\r\n        // 性别\r\n        if (IdNmber.length == 17 || IdNmber.length == 18) {\r\n          if (sex % 2 == 0) {\r\n            this.form.Sex = '女'\r\n          } else if (sex % 2 == 1) {\r\n            this.form.Sex = '男'\r\n          }\r\n        }\r\n      }\r\n    },\r\n    //获取选择到的患者信息\r\n    getSelectRespons (data) {\r\n      this.form.Name = data[0].Name\r\n      this.form.CardNo = data[0].CardNo\r\n      this.form.Phone = data[0].Phone\r\n      this.form.PersonId = data[0].PersonId;\r\n    },\r\n    // 选择患者\r\n    clickpatientselect () {\r\n      var param = {\r\n        title: '选择患者',\r\n        visible: true,\r\n        OrganizationId: this.form.AdminOrganization,\r\n        num: 1\r\n      }\r\n      this.$refs.patientselectlist.getDetail(param)\r\n    },\r\n    // 字典数据请求\r\n    async funusedictionarydetails (params) {\r\n      const res = await usedictionarydetails({\r\n        CategoryCode: ['A0021', 'A0003', 'A0013', 'A0014', 'A0015', 'A0016', 'A0017', 'A0001', 'A0039', 'A0040', 'A0041', 'A0024'],\r\n        PageNumber: 1,\r\n        PageSize: 90\r\n      })\r\n      let {\r\n        StatusCode,\r\n        Message\r\n      } = res\r\n      if (!res || StatusCode !== 200) {\r\n        return this.$baseMessage(Message || '数据获取失败', 'error')\r\n      }\r\n      this.dictarr = res.Response.items\r\n    },\r\n    //字典数据处理\r\n    fundictlist () {\r\n      this.dictarr.forEach(item => {\r\n        if (item.CategoryCode == 'A0003') {\r\n          this.A0003.push(item)\r\n        } else if (item.CategoryCode == 'A0013') {\r\n          this.A0013.push(item)\r\n        } else if (item.CategoryCode == 'A0014') {\r\n          this.A0014.push(item)\r\n        } else if (item.CategoryCode == 'A0015') {\r\n          this.A0015.push(item)\r\n        } else if (item.CategoryCode == 'A0016') {\r\n          this.A0016.push(item)\r\n        } else if (item.CategoryCode == 'A0017') {\r\n          this.A0017.push(item)\r\n        } else if (item.CategoryCode == 'A0001') {\r\n          this.A0001.push(item)\r\n        } else if (item.CategoryCode == 'A0021') {\r\n          this.A0021.push(item)\r\n        } else if (item.CategoryCode == 'A0039') {\r\n          this.A0039.push(item)\r\n        } else if (item.CategoryCode == 'A0040') {\r\n          this.A0040.push(item)\r\n        } else if (item.CategoryCode == 'A0041') {\r\n          this.A0041.push(item)\r\n        } else if (item.CategoryCode == 'A0024') {\r\n          this.A0024.push(item)\r\n        }\r\n      })\r\n    },\r\n    // 治疗方案\r\n    async funtreatmentplantemplates (params) {\r\n\r\n      const res = await treatmentplantemplates({\r\n        PageSize: 999\r\n      })\r\n      this.TreatmentPlanId = res.Response.items\r\n    }\r\n\r\n  },\r\n  watch: {\r\n    'form.TreatmentPlanId': function (val) {\r\n      for (let i in this.TreatmentPlanId) {\r\n        if (this.TreatmentPlanId[i].TreatmentPlanId == this.form.TreatmentPlanId) {\r\n          this.StrengtheningPeriodDMT = this.TreatmentPlanId[i].StrengtheningPeriodDMT;\r\n          this.ConsolidationPeriodMonth = this.TreatmentPlanId[i].ConsolidationPeriodMonth;\r\n          this.ConsolidationPeriodDMT = this.TreatmentPlanId[i].ConsolidationPeriodDMT;\r\n          this.StrengtheningPeriodMonth = this.TreatmentPlanId[i].StrengtheningPeriodMonth;\r\n        }\r\n      }\r\n    },\r\n    // 'form.XianAdminOrganization': function(val) {\r\n    // \t// this.form.MedicineAdminOrganization = '';\r\n    // \t// this.form.AdminOrganization= '';\r\n    // \tthis.getMedicineAdminOrganizationlist() //服药单位列表\r\n    // },\r\n    // 'form.MedicineAdminOrganization': function(val) {\r\n    // \t// this.form.AdminOrganization= '';\r\n    // \tthis.getAdminOrganizationlist() //督导单位列表\r\n    // }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=scss scoped>\r\n.el-row {\r\n  margin: 1px 0;\r\n}\r\n\r\n.contentbox {\r\n  height: 600px;\r\n}\r\n\r\n.el-colname {\r\n  margin-left: 60px;\r\n}\r\n\r\n.headingstyles {\r\n  line-height: 25px;\r\n}\r\n</style>\r\n"]}]}