{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\patientManagement\\unassignedrecord\\components\\tabComponents\\EditComponents\\PulmonaryMedicineList.vue?vue&type=style&index=0&id=ccf1c85a&scoped=true&lang=scss&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\patientManagement\\unassignedrecord\\components\\tabComponents\\EditComponents\\PulmonaryMedicineList.vue","mtime":1678931188674},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\css-loader\\dist\\cjs.js","mtime":1678931311747},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1678931317953},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\postcss-loader\\src\\index.js","mtime":1678931314216},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1678931310798},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678931310818},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js","mtime":1678931316857}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmFwcC1wYWdpbmF0aW9uIHsNCiAgZm9udC1zaXplOiAxM3B4Ow0KICBmb250LWZhbWlseTogTWljcm9zb2Z0IFlhSGVpOw0KICBmb250LXdlaWdodDogNDAwOw0KICBjb2xvcjogIzMwMzEzMzsNCiAgd2lkdGg6IDEwMCU7DQogIGJhY2tncm91bmQtY29sb3I6ICNmZmY7DQogIHBhZGRpbmctdG9wOiAyMHB4Ow0KICBkaXNwbGF5OiAtd2Via2l0LWJveDsNCiAgZGlzcGxheTogLW1zLWZsZXhib3g7DQogIGRpc3BsYXk6IGZsZXg7DQogIC13ZWJraXQtYm94LXBhY2s6IGp1c3RpZnk7DQogIC1tcy1mbGV4LXBhY2s6IGp1c3RpZnk7DQogIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgLXdlYmtpdC1ib3gtYWxpZ246IGNlbnRlcjsNCiAgLW1zLWZsZXgtYWxpZ246IGNlbnRlcjsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCn0NCg0KLmFwcC1wYWdpbmF0aW9uIC5wYWdpbmctdG90YWwgew0KICBmb250LXNpemU6IDEzcHg7DQogIGZvbnQtZmFtaWx5OiBNaWNyb3NvZnQgWWFIZWk7DQogIGZvbnQtd2VpZ2h0OiA0MDA7DQogIGNvbG9yOiAjNjA2MjY2Ow0KfQ0KLm10MTAgew0KICBtYXJnaW4tdG9wOiAxMHB4Ow0KfQ0KOjp2LWRlZXAgew0KICAuZWwtaW5wdXQtLW1lZGl1bSAuZWwtaW5wdXRfX2lubmVyIHsNCiAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50Ow0KICB9DQogIC5kaWFsb2ctZm9vdGVyIHsNCiAgICBmbG9hdDogcmlnaHQ7DQogIH0NCn0NCg=="},{"version":3,"sources":["PulmonaryMedicineList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PulmonaryMedicineList.vue","sourceRoot":"src/views/patientManagement/unassignedrecord/components/tabComponents/EditComponents","sourcesContent":["<template>\r\n  <vxe-modal\r\n    :title=\"formConfig.title\"\r\n    v-model=\"formConfig.visible\"\r\n    :width=\"formConfig.width\"\r\n    :height=\"formConfig.height\"\r\n    :close-on-click-modal=\"false\"\r\n    :close-on-press-escape=\"false\"\r\n    @close=\"handleClose\"\r\n    modal-append-to-body\r\n    append-to-body\r\n    :z-index=\"3000\"\r\n  >\r\n    <div style=\"overflow-x: hidden\">\r\n      <el-form ref=\"searchForm\" style=\"margin-top: 10px\" :model=\"searchForm\" label-width=\"90px\">\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item field=\"CardNo\" label=\"服药日期:\">\r\n              <el-date-picker\r\n                @change=\"changeSubmitTimes\"\r\n                v-model=\"searchForm.SubmitTimes\"\r\n                unlink-panels\r\n                type=\"daterange\"\r\n                style=\"width:100%\"\r\n                align=\"center\"\r\n                value-format=\"yyyy-MM-dd HH:mm:ss\"\r\n              ></el-date-picker>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"10\">\r\n            <el-button @click=\"queryBtn\" type=\"primary\" style=\"margin-left: 10px\">查询</el-button>\r\n            <el-button @click=\"resetBtn\" plain>重置</el-button>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n      <vxe-table\r\n        :data=\"tableData\"\r\n        border\r\n        @cell-dblclick=\"cellDbRow\"\r\n        ref=\"xTable1\"\r\n        height=\"360\"\r\n        :checkbox-config=\"{ trigger: 'row' }\"\r\n        @checkbox-change=\"checkboxChange\"\r\n        @checkbox-all=\"checkboxAll\"\r\n      >\r\n        <vxe-table-column type=\"checkbox\" width=\"55\" align=\"center\"></vxe-table-column>\r\n        <vxe-column field=\"AbnormalDate\" title=\"异常服药日期\">\r\n          <template slot-scope=\"scope\">\r\n            <div>{{ scope.row.AbnormalDate.slice(0, 10) }}</div>\r\n          </template>\r\n        </vxe-column>\r\n        <vxe-column field=\"AbnormalType\" title=\"异常类型\">\r\n          <template slot-scope=\"scope\">\r\n            <div v-if=\"scope.row.AbnormalType == 1\">中断服药</div>\r\n            <div v-else>异常服药</div>\r\n          </template>\r\n        </vxe-column>\r\n        <vxe-column field=\"ShouldTakeMedicineTimes\" title=\"应服药次数\"></vxe-column>\r\n        <vxe-column field=\"ActualTakeMedicineTimes\" title=\"实际服药次数\"></vxe-column>\r\n      </vxe-table>\r\n      <!-- 分页 -->\r\n      <div class=\"app-pagination\" ref=\"appPagination\">\r\n        <div class=\"paging-total\">共{{ totalcount }}条</div>\r\n        <div>\r\n          <el-pagination\r\n            layout=\"prev, pager, next\"\r\n            :total=\"totalcount\"\r\n            :page-size=\"pageSize\"\r\n            ref=\"elPage\"\r\n            @size-change=\"handleSizeChange\"\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page.sync=\"pagenum\"\r\n          ></el-pagination>\r\n        </div>\r\n      </div>\r\n      <span Slots=\"footer\" class=\"dialog-footer mt10\">\r\n        <el-button class=\"cancelbtn\" @click=\"handleClose\">关 闭</el-button>\r\n        <el-button class=\"savebtn\" type=\"primary\" @click=\"submit\">选 择</el-button>\r\n      </span>\r\n    </div>\r\n  </vxe-modal>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  pulmonarymedicineabnormal,\r\n  pulmonarymedicinesupplement\r\n} from '@/api/PulmonaryMedicine'\r\nexport default {\r\n  data () {\r\n    return {\r\n      // 表单配置\r\n      formConfig: {\r\n        title: '',\r\n        visible: false,\r\n        width: '56%',\r\n        opt: '',\r\n        height: '85%',\r\n        num: 9999\r\n      },\r\n      checkRows: [],\r\n      searchForm: {\r\n        CardNo: '',\r\n        Name: \"\",\r\n        pageIndex: 1,\r\n        pageSize: 10,\r\n        SelectOnly: false,\r\n        RegionCode: '',\r\n        AdminOrganization: '',\r\n        SubmitTimes: [],\r\n      },\r\n      totalcount: 0, //总条数\r\n      pageSize: 10, // 每页显示条数\r\n      pagenum: 1, // 当前页码\r\n      tableData: [],//表格数据\r\n      selectTableData: [],//选择的表格数据\r\n    };\r\n  },\r\n  created () {\r\n\r\n  },\r\n  filters: {\r\n    AbnormalTypelist (row) {\r\n      switch (row.row.AbnormalType) {\r\n        case '1':\r\n          return '中断服药'\r\n        case '2':\r\n          return '异常服药';\r\n        default:\r\n          return '';\r\n      }\r\n    },\r\n\r\n  },\r\n  methods: {\r\n    //查询按钮\r\n    queryBtn () {\r\n      this.pagenum = 1;\r\n      this.query();\r\n    },\r\n    //重置\r\n    resetBtn () {\r\n      var datetime = new Date();\r\n      var year = datetime.getFullYear(); //获取完整的年份(4位,如:1970)\r\n      var month = datetime.getMonth() + 1; //获取月份(返回0-11,0代表1月,用的时候记得加上1)\r\n      var date = datetime.getDate() - 7; //获取日(返回1-31)\r\n      var date1 = datetime.getDate(); //获取日(返回1-31)\r\n      //判断小于等于9月的时候在月份前加一个\"0\"\r\n      if (month <= 9) {\r\n        month = \"0\" + month;\r\n      }\r\n      //判断小于等于9号的时候在天数前加一个\"0\"\r\n      if (date <= 9) {\r\n        date = \"0\" + date;\r\n      }\r\n     this.searchForm.SubmitTimes.push(this.formtime(new Date())) //给建档时间默认当前\r\n     this.searchForm.SubmitTimes.push(this.formtime(new Date().getTime() - 3600 * 1000 * 24 * 30))\r\n      this.query()\r\n    },\r\n    //格式化时间显示\r\n    formatterDate (row, column, cellValue, index) {\r\n      return row.row.birthday.slice(0, 10)\r\n    },\r\n    //每页显示条目个数改变时\r\n    handleSizeChange (val) {\r\n      this.pageSize = val;\r\n      this.pagenum = 1;\r\n      this.query();\r\n    },\r\n    //当前页改变时\r\n    handleCurrentChange (val) {\r\n      this.pagenum = val;\r\n      this.query();\r\n    },\r\n    cellDbRow ({ row, rowIndex, $rowIndex, column, columnIndex, $columnIndex, $event }) {\r\n      let selectData = this.$refs.xTable1.getCheckboxRecords();\r\n      selectData.push(row)\r\n      this.$emit(\"selectSubmit\", selectData);\r\n      this.handleClose()\r\n    },\r\n    // 获取服药记录信息列表\r\n    async query () {\r\n      const res = await pulmonarymedicineabnormal(this.searchForm.DiagnosisId, this.searchForm.SubmitConfirm, this.searchForm.SubmitTimes[0], this.searchForm.SubmitTimes[1], this.pagenum, this.pageSize)\r\n      this.tableLoading = false;\r\n      this.totalcount = res.Response.TotalCount; // 总条数\r\n      this.tableData = res.Response.items;\r\n    },\r\n    //选择的表格数据\r\n    submit () {\r\n      let len = this.checkRows.length;\r\n      if (!len) {\r\n        return this.$baseMessage(\"至少选择一项！\", \"error\");\r\n      }\r\n      this.$baseConfirm(\"确定要提交选中的数据吗？\", null,\r\n        // 将选中的数据添加属性删除\r\n        async () => {\r\n          let storeId = this.checkRows.map((item) => {\r\n            return item.AbnormalDate\r\n          })\r\n          //派发请求\r\n          const res = await pulmonarymedicinesupplement(this.checkRows[0].DiagnosisId, storeId)\r\n          this.$emit(\"selectSubmit\");\r\n          this.handleClose()\r\n          this.$baseMessage('确认成功', \"success\")\r\n        }\r\n      )\r\n\r\n    },\r\n    //选择服药时间\r\n    changeSubmitTimes (value) {\r\n      this.searchForm.SubmitTimes = value;\r\n    },\r\n    // 初始化弹框，获取详情\r\n    getDetail (param) {\r\n      this.formConfig = Object.assign(this.formConfig, param);\r\n      this.tableLoading = true;\r\n      this.searchForm.PageSize = this.pageSize;\r\n      this.searchForm.PageNumber = this.pagenum;\r\n      this.searchForm.SubmitConfirm = this.formConfig.SubmitConfirm;\r\n      this.searchForm.DiagnosisId = this.formConfig.DiagnosisId;\r\n\r\n      var datetime = new Date();\r\n      var year = datetime.getFullYear(); //获取完整的年份(4位,如:1970)\r\n      var month = datetime.getMonth() + 1; //获取月份(返回0-11,0代表1月,用的时候记得加上1)\r\n      var date = datetime.getDate() - 7; //获取日(返回1-31)\r\n      var date1 = datetime.getDate(); //获取日(返回1-31)\r\n      //判断小于等于9月的时候在月份前加一个\"0\"\r\n      if (month <= 9) {\r\n        month = \"0\" + month;\r\n      }\r\n      //判断小于等于9号的时候在天数前加一个\"0\"\r\n      if (date <= 9) {\r\n        date = \"0\" + date;\r\n      }\r\n      this.searchForm.SubmitTimes.push(this.formtime(new Date())) //给建档时间默认当前\r\n      this.searchForm.SubmitTimes.push(this.formtime(new Date().getTime() - 3600 * 1000 * 24 * 30))\r\n      this.query();\r\n    },\r\n    // 复选框事件\r\n    checkboxChange ({\r\n      records\r\n    }) {\r\n      this.checkRows = records\r\n    },\r\n    // 全选按钮事件\r\n    checkboxAll ({\r\n      records\r\n    }) {\r\n      this.checkRows = records\r\n    },\r\n\tformtime(endDate) {\r\n\t\tlet endTime = endDate - 600000\r\n\t\tlet dates = new Date(endTime)\r\n\t\tlet y = dates.getFullYear() // 年\r\n\t\tlet MM = dates.getMonth() + 1 // ⽉\r\n\t\tMM = MM < 10 ? ('0' + MM) : MM\r\n\t\tlet d = dates.getDate() // ⽇\r\n\t\td = d < 10 ? ('0' + d) : d\r\n\t\treturn y + '-' + MM + '-' + d\r\n\t},\r\n    //关闭弹框\r\n    handleClose () {\r\n      this.$refs.xTable1.clearCheckboxRow();\r\n      this.formConfig.visible = false;\r\n    },\r\n  }\r\n};\r\n</script>\r\n<style scoped lang='scss'>\r\n.app-pagination {\r\n  font-size: 13px;\r\n  font-family: Microsoft YaHei;\r\n  font-weight: 400;\r\n  color: #303133;\r\n  width: 100%;\r\n  background-color: #fff;\r\n  padding-top: 20px;\r\n  display: -webkit-box;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-pack: justify;\r\n  -ms-flex-pack: justify;\r\n  justify-content: space-between;\r\n  -webkit-box-align: center;\r\n  -ms-flex-align: center;\r\n  align-items: center;\r\n}\r\n\r\n.app-pagination .paging-total {\r\n  font-size: 13px;\r\n  font-family: Microsoft YaHei;\r\n  font-weight: 400;\r\n  color: #606266;\r\n}\r\n.mt10 {\r\n  margin-top: 10px;\r\n}\r\n::v-deep {\r\n  .el-input--medium .el-input__inner {\r\n    width: 100% !important;\r\n  }\r\n  .dialog-footer {\r\n    float: right;\r\n  }\r\n}\r\n</style>\r\n"]}]}