{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\systemManagement\\treatmentplantemplates\\components\\pageEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\systemManagement\\treatmentplantemplates\\components\\pageEdit.vue","mtime":1678931188725},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678931310818},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\babel-loader\\lib\\index.js","mtime":1678931314285},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678931310818},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js","mtime":1678931316857}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyB0cmVhdG1lbnRwbGFudGVtTW9kaWZ5LCB0cmVhdG1lbnRwbGFudGVtcGxhdGVzRGV0YWlscywgdHJlYXRtZW50cGxhbnJlY29yZEVkaXQgfSBmcm9tICJAL2FwaS9UcmVhdG1lbnRQbGFuVGVtcGxhdGUiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhICgpIHsNCiAgICByZXR1cm4gew0KICAgICAgLy8g6KGo5Y2V6YWN572uDQogICAgICBmb3JtQ29uZmlnOiB7DQogICAgICAgIHRpdGxlOiAiIiwNCiAgICAgICAgdmlzaWJsZTogZmFsc2UsDQogICAgICAgIHdpZHRoOiAiNzAlIiwNCiAgICAgICAgb3B0OiAiIiwNCiAgICAgICAgbG9hZGluZzogZmFsc2UsDQogICAgICAgIHJlZGVyVmlldzogdHJ1ZQ0KICAgICAgfSwNCiAgICAgIC8vIOihqOWNleaVsOaNrg0KICAgICAgZm9ybURhdGE6IHt9LA0KICAgICAgZm9ybURhdGFDb3B5OiB7fSwNCiAgICAgIC8vIOmqjOivgeinhOWImQ0KICAgICAgZm9ybVJ1bGVzOiB7fSwNCiAgICB9Ow0KICB9LA0KICBjcmVhdGVkICgpIHsNCiAgICB0aGlzLnNldGZvcm1SdWxlcygpDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBzZXRmb3JtUnVsZXMgKCkgew0KICAgICAgbGV0IGFyciA9IFsNCiAgICAgICAgeyB0cmlnZ2VyOiAnYmx1cicsIG1lc3NhZ2U6ICLmsrvnlpfmlrnmoYjlkI3np7AiLCBrZXk6ICJUcmVhdG1lbnRQbGFuTmFtZSIgfSwNCiAgICAgICAgeyB0cmlnZ2VyOiAnYmx1cicsIG1lc3NhZ2U6ICLlvLrljJbmnJ8iLCBrZXk6ICJTdHJlbmd0aGVuaW5nUGVyaW9kTW9udGgiIH0sDQogICAgICAgIHsgdHJpZ2dlcjogJ2JsdXInLCBtZXNzYWdlOiAi5by65YyW5pyf5pyN6I2v6aKR546HIiwga2V5OiAiU3RyZW5ndGhlbmluZ1BlcmlvZERNVCIgfSwNCiAgICAgICAgeyB0cmlnZ2VyOiAnYmx1cicsIG1lc3NhZ2U6ICLlt6nlm7rmnJ8iLCBrZXk6ICJDb25zb2xpZGF0aW9uUGVyaW9kTW9udGgiIH0sDQogICAgICAgIHsgdHJpZ2dlcjogJ2JsdXInLCBtZXNzYWdlOiAi5bep5Zu65pyf5pyN6I2v6aKR546HIiwga2V5OiAiQ29uc29saWRhdGlvblBlcmlvZERNVCIgfSwNCiAgICAgIF0NCiAgICAgIGZvciAobGV0IGl0ZW0gb2YgYXJyKSB7DQogICAgICAgIGxldCBvYmogPSB7DQogICAgICAgICAgdHJpZ2dlcjogaXRlbS50cmlnZ2VyLA0KICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLA0KICAgICAgICB9DQogICAgICAgIGlmIChpdGVtLnRyaWdnZXIgPT0gJ2JsdXInKSBvYmoubWVzc2FnZSA9IGl0ZW0ubWVzc2FnZSArICfkuI3og73kuLrnqbonOw0KICAgICAgICBpZiAoaXRlbS50cmlnZ2VyID09ICdjaGFuZ2UnKSBvYmoubWVzc2FnZSA9ICfor7fpgInmi6knICsgaXRlbS5tZXNzYWdlOw0KICAgICAgICB0aGlzLmZvcm1SdWxlc1tpdGVtLmtleV0gPSBvYmoNCiAgICAgIH0NCiAgICB9LA0KICAgIC8v5YWz6Zet5by55qGGDQogICAgaGFuZGxlQ2xvc2UgKCkgew0KICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICB0aGlzLiRyZWZzWydyZWZGb3JtJ10ucmVzZXRGaWVsZHMoKTsNCiAgICAgIH0pDQogICAgICB0aGlzLmZvcm1Db25maWcudmlzaWJsZSA9IGZhbHNlOw0KICAgIH0sDQogICAgLy8g5o+Q5LqkDQogICAgc3VibWl0ICgpIHsNCiAgICAgIGxldCB0aGF0ID0gdGhpczsNCiAgICAgIHRoaXMuJHJlZnMucmVmRm9ybS52YWxpZGF0ZShhc3luYyAodmFsaWQpID0+IHsNCiAgICAgICAgaWYgKHZhbGlkKSB7DQogICAgICAgICAgaWYgKHRoYXQuZm9ybUNvbmZpZy5vcHQgPT0gJ2FkZCcpIHsNCiAgICAgICAgICAgIGF3YWl0IHRyZWF0bWVudHBsYW50ZW1Nb2RpZnkodGhhdC5mb3JtRGF0YSk7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuaWsOWinuaIkOWKnyIpOw0KICAgICAgICAgICAgdGhhdC4kZW1pdCgic3VibWl0IikNCiAgICAgICAgICAgIHRoYXQuaGFuZGxlQ2xvc2UoKQ0KICAgICAgICAgIH0NCiAgICAgICAgICBpZiAodGhhdC5mb3JtQ29uZmlnLm9wdCA9PSAnZWRpdCcpIHsNCiAgICAgICAgICAgIGxldCBhcnIgPSB0aGF0LiR1dGlsc0Z1bi5jb21wYXJlT2JqKHRoYXQuZm9ybURhdGEsIHRoYXQuZm9ybURhdGFDb3B5KQ0KICAgICAgICAgICAgYXdhaXQgdHJlYXRtZW50cGxhbnJlY29yZEVkaXQoew0KICAgICAgICAgICAgICBUcmVhdG1lbnRQbGFuSWQ6IHRoYXQuZm9ybURhdGEuVHJlYXRtZW50UGxhbklkLA0KICAgICAgICAgICAgICBkYXRhOiBhcnINCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIue8lui+keaIkOWKnyIpOw0KICAgICAgICAgICAgdGhhdC4kZW1pdCgic3VibWl0IikNCiAgICAgICAgICAgIHRoYXQuaGFuZGxlQ2xvc2UoKQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICAvLyDliJ3lp4vljJblvLnmoYbvvIzojrflj5bor6bmg4UNCiAgICBhc3luYyBnZXREZXRhaWwgKHBhcmFtKSB7DQogICAgICBsZXQgdGhhdCA9IHRoaXM7DQogICAgICBpZiAocGFyYW0ub3B0ID09ICIiIHx8IHBhcmFtLm9wdCA9PSBudWxsKSB7DQogICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCLmnKrnn6Xmk43kvZwiKTsNCiAgICAgIH0NCiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgdGhhdC5mb3JtRGF0YSA9IHsgLi4ue30gfQ0KICAgICAgfSkNCiAgICAgIHRoaXMuZm9ybUNvbmZpZyA9IE9iamVjdC5hc3NpZ24odGhpcy5mb3JtQ29uZmlnLCBwYXJhbSk7DQogICAgICAvLyDnvJbovpHkuYvliY3lhYjljrvmn6Xor6Lor6bmg4UNCiAgICAgIGlmIChwYXJhbS5vcHQgPT09ICJlZGl0Iikgew0KICAgICAgICBsZXQgcmVzID0gYXdhaXQgdHJlYXRtZW50cGxhbnRlbXBsYXRlc0RldGFpbHMocGFyYW0uVHJlYXRtZW50UGxhbklkKTsNCiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgIHRoaXMuZm9ybURhdGEgPSB7DQogICAgICAgICAgICAuLi5yZXMuUmVzcG9uc2UNCiAgICAgICAgICB9DQogICAgICAgIH0pDQogICAgICAgIHRoaXMuZm9ybURhdGFDb3B5ID0gcmVzLlJlc3BvbnNlDQogICAgICB9DQogICAgICB0aGlzLmZvcm1Db25maWcubG9hZGluZyA9IGZhbHNlOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["pageEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"pageEdit.vue","sourceRoot":"src/views/systemManagement/treatmentplantemplates/components","sourcesContent":["<template>\r\n  <el-dialog\r\n    :title=\"formConfig.title\"\r\n    :visible.sync=\"formConfig.visible\"\r\n    :width=\"formConfig.width\"\r\n    :close-on-click-modal=\"false\"\r\n    :close-on-press-escape=\"false\"\r\n    @close=\"handleClose\"\r\n    top=\"20vh\"\r\n  >\r\n    <div slot=\"title\" class=\"dialog-title\">\r\n      <div class=\"sectionstly\"></div>\r\n      <span class=\"title-text\">{{ formConfig.title }}</span>\r\n      <div class=\"button-right\">\r\n        <span class=\"title-close\" @click=\"handleClose\"></span>\r\n      </div>\r\n    </div>\r\n    <el-form :model=\"formData\" :rules=\"formRules\" v-loading=\"formConfig.loading\" ref=\"refForm\" label-width=\"130px\" class=\"form_row\">\r\n      <div class=\"el-dialog-div\" style=\"height: 50vh\">\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"治疗方案名称:\" prop=\"TreatmentPlanName\">\r\n              <el-input v-model=\"formData.TreatmentPlanName\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"强化期:\" prop=\"StrengtheningPeriodMonth\">\r\n              <el-input v-model=\"formData.StrengtheningPeriodMonth\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"强化期服药频率:\" prop=\"StrengtheningPeriodDMT\">\r\n              <el-input v-model=\"formData.StrengtheningPeriodDMT\" />\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"巩固期:\" prop=\"ConsolidationPeriodMonth\">\r\n              <el-input v-model=\"formData.ConsolidationPeriodMonth\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col :span=\"12\">\r\n            <el-form-item label=\"巩固期服药频率:\" prop=\"ConsolidationPeriodDMT\">\r\n              <el-input v-model=\"formData.ConsolidationPeriodDMT\" />\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-row>\r\n      </div>\r\n    </el-form>\r\n    <span slot=\"footer\" class=\"dialog-footer\">\r\n      <el-button class=\"cancelbtn\" @click=\"handleClose\">取 消</el-button>\r\n      <el-button class=\"savebtn\" type=\"primary\" @click=\"submit\">确 定</el-button>\r\n    </span>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { treatmentplantemModify, treatmentplantemplatesDetails, treatmentplanrecordEdit } from \"@/api/TreatmentPlanTemplate\";\r\nexport default {\r\n  data () {\r\n    return {\r\n      // 表单配置\r\n      formConfig: {\r\n        title: \"\",\r\n        visible: false,\r\n        width: \"70%\",\r\n        opt: \"\",\r\n        loading: false,\r\n        rederView: true\r\n      },\r\n      // 表单数据\r\n      formData: {},\r\n      formDataCopy: {},\r\n      // 验证规则\r\n      formRules: {},\r\n    };\r\n  },\r\n  created () {\r\n    this.setformRules()\r\n  },\r\n  methods: {\r\n    setformRules () {\r\n      let arr = [\r\n        { trigger: 'blur', message: \"治疗方案名称\", key: \"TreatmentPlanName\" },\r\n        { trigger: 'blur', message: \"强化期\", key: \"StrengtheningPeriodMonth\" },\r\n        { trigger: 'blur', message: \"强化期服药频率\", key: \"StrengtheningPeriodDMT\" },\r\n        { trigger: 'blur', message: \"巩固期\", key: \"ConsolidationPeriodMonth\" },\r\n        { trigger: 'blur', message: \"巩固期服药频率\", key: \"ConsolidationPeriodDMT\" },\r\n      ]\r\n      for (let item of arr) {\r\n        let obj = {\r\n          trigger: item.trigger,\r\n          required: true,\r\n        }\r\n        if (item.trigger == 'blur') obj.message = item.message + '不能为空';\r\n        if (item.trigger == 'change') obj.message = '请选择' + item.message;\r\n        this.formRules[item.key] = obj\r\n      }\r\n    },\r\n    //关闭弹框\r\n    handleClose () {\r\n      this.$nextTick(() => {\r\n        this.$refs['refForm'].resetFields();\r\n      })\r\n      this.formConfig.visible = false;\r\n    },\r\n    // 提交\r\n    submit () {\r\n      let that = this;\r\n      this.$refs.refForm.validate(async (valid) => {\r\n        if (valid) {\r\n          if (that.formConfig.opt == 'add') {\r\n            await treatmentplantemModify(that.formData);\r\n            this.$message.success(\"新增成功\");\r\n            that.$emit(\"submit\")\r\n            that.handleClose()\r\n          }\r\n          if (that.formConfig.opt == 'edit') {\r\n            let arr = that.$utilsFun.compareObj(that.formData, that.formDataCopy)\r\n            await treatmentplanrecordEdit({\r\n              TreatmentPlanId: that.formData.TreatmentPlanId,\r\n              data: arr\r\n            })\r\n            this.$message.success(\"编辑成功\");\r\n            that.$emit(\"submit\")\r\n            that.handleClose()\r\n          }\r\n        }\r\n      });\r\n    },\r\n    // 初始化弹框，获取详情\r\n    async getDetail (param) {\r\n      let that = this;\r\n      if (param.opt == \"\" || param.opt == null) {\r\n        return this.$message.error(\"未知操作\");\r\n      }\r\n      this.$nextTick(() => {\r\n        that.formData = { ...{} }\r\n      })\r\n      this.formConfig = Object.assign(this.formConfig, param);\r\n      // 编辑之前先去查询详情\r\n      if (param.opt === \"edit\") {\r\n        let res = await treatmentplantemplatesDetails(param.TreatmentPlanId);\r\n        this.$nextTick(() => {\r\n          this.formData = {\r\n            ...res.Response\r\n          }\r\n        })\r\n        this.formDataCopy = res.Response\r\n      }\r\n      this.formConfig.loading = false;\r\n    },\r\n  },\r\n};\r\n</script>\r\n"]}]}