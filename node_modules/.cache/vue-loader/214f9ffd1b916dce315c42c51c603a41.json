{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\systemManagement\\announcementManagement\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\systemManagement\\announcementManagement\\index.vue","mtime":1678931188719},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678931310818},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\babel-loader\\lib\\index.js","mtime":1678931314285},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678931310818},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js","mtime":1678931316857}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovLyDlrZflhbgNCmltcG9ydCB7DQogIHVzZWRpY3Rpb25hcnlkZXRhaWxzDQp9IGZyb20gJ0AvYXBpL2RpY3QuanMnDQppbXBvcnQgRWRpdCBmcm9tICJAL3ZpZXdzL3N5c3RlbU1hbmFnZW1lbnQvYW5ub3VuY2VtZW50TWFuYWdlbWVudC9lZGl0LnZ1ZSINCi8vIGFwaQ0KaW1wb3J0IHsNCiAgZ2V0QW5ub3VuY2VtZW50cywNCiAgYWRkT3JVcGRhdGFBbm5vdW5jZW1lbnRzLA0KICBkZWxBbm5vdW5jZW1lbnRzLA0KICB1cGRhdGFBbm5vdW5jZQ0KfSBmcm9tICdAL2FwaS9hbm5vdWNlbWVudCcNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ0Fubm91bmNlbWVudE1hbmFnZW1lbnQnLA0KICBjb21wb25lbnRzOiB7DQogICAgRWRpdA0KICB9LA0KICBkYXRhICgpIHsNCiAgICByZXR1cm4gew0KICAgICAgdGl0bGU6ICIiLA0KICAgICAga2V5d29yZDogJycsDQogICAgICBmbGFnOiAnJywNCiAgICAgIEEwMDMyOiBbXSwNCiAgICAgIEEwMDMzOiBbXSwNCiAgICAgIGFubm91bmNlbWVudExpc3Q6IFtdLA0KICAgICAgYW5ub3VuY2VtZW50dGFibGU6IFtdLA0KICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLA0KICAgICAgc2hvd1NlYXJjaDogdHJ1ZSwNCiAgICAgIGZvcm06IHsNCiAgICAgICAgLy8g55m75b2V57yT5a2Y5Lit6I635Y+W55qE5rS+5Y+R5Y+C5pWwDQogICAgICAgIEFubm91bmNlbWVudElkOiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySW5mbycpKS51c2VySWQsDQogICAgICAgIEN1cnJlbnRQYWdlOiAxLA0KICAgICAgICBQYWdlU2l6ZTogMTAsDQogICAgICAgIFRvdGFsUGFnZXM6IDAsDQogICAgICB9LA0KICAgICAgdGFibGVIZWlnaHQ6ICIzMDAiLCAvL3RhYmxl6auY5bqmDQogICAgICBzZWFyY2hSZXN1bHQ6IFtdDQogICAgfQ0KICB9LA0KICBjcmVhdGVkICgpIHsNCg0KICB9LA0KICBtb3VudGVkICgpIHsNCiAgICB0aGlzLmdldEFubm91bmNlbWVudHNMaXN0KCkNCiAgICB0aGlzLmluaXRUYWJsZUhlaWdodCgpOw0KICB9LA0KICAvLyBjb21wdXRlZDogew0KICAvLyAgIHNlYXJjaFJlc3VsdCgpIHsNCiAgLy8gICAgIGlmICh0aGlzLmtleXdvcmQpIHsNCiAgLy8gICAgICAgcmV0dXJuIHRoaXMuYW5ub3VuY2VtZW50TGlzdC5maWx0ZXIoKGl0ZW0pID0+IHsNCiAgLy8gICAgICAgICByZXR1cm4gaXRlbS5Db250ZW50LmluZGV4T2YodGhpcy5rZXl3b3JkKSAhPT0gLTENCiAgLy8gICAgICAgfSkNCiAgLy8gICAgIH0gZWxzZSB7DQogIC8vICAgICAgIHJldHVybiB0aGlzLmFubm91bmNlbWVudExpc3Q7DQogIC8vICAgICB9DQogIC8vICAgfSwNCiAgLy8gfSwNCg0KICBtZXRob2RzOiB7DQogICAgLy8g6I635Y+W5pWw5o2uDQogICAgZ2V0QW5ub3VuY2VtZW50c0xpc3QgKCkgew0KICAgICAgZ2V0QW5ub3VuY2VtZW50cyh0aGlzLmZvcm0pLnRoZW4oKHJlcykgPT4gew0KICAgICAgICB0aGlzLmFubm91bmNlbWVudExpc3QgPSBbLi4ucmVzLlJlc3BvbnNlLml0ZW1zXTsNCiAgICAgICAgdGhpcy5zZWFyY2hSZXN1bHQgPSBbLi4ucmVzLlJlc3BvbnNlLml0ZW1zXTsNCiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmZvcm0sIHJlcy5SZXNwb25zZSk7DQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g5pCc57SiDQogICAgc2VhcmNoTGlzdCAoKSB7DQogICAgICB0aGlzLmdldEFubm91bmNlbWVudHNMaXN0KCkNCiAgICB9LA0KICAgIC8v6YeN572uDQogICAgcmVzZXRCdG4gKCkgew0KICAgICAgdGhpcy5mb3JtLlRpdGxlID0gJyc7DQogICAgICB0aGlzLmdldEFubm91bmNlbWVudHNMaXN0KCkNCiAgICB9LA0KICAgIC8vIOWIoOmZpA0KICAgIGFzeW5jIGRlbEFubm91bmNlbWVudCAoZGF0YSkgew0KICAgICAgdGhpcy4kY29uZmlybShg56Gu6K6k6KaB5Yig6Zmk6L+Z5p2h5pWw5o2u5ZCXP2AsICLliKDpmaQiLCB7DQogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwNCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogIuWPlua2iCIsDQogICAgICAgIHR5cGU6ICJlcnJvciIsDQogICAgICAgIHJvdW5kQnV0dG9uOnRydWUsDQogICAgICB9KS50aGVuKGFzeW5jICgpID0+IHsNCiAgICAgICAgbGV0IG9wID0gW2RhdGEuQW5ub3VuY2VtZW50SWRdDQogICAgICAgIGxldCByZXMgPSBhd2FpdCBkZWxBbm5vdW5jZW1lbnRzKG9wKQ0KICAgICAgICBpZiAocmVzLlN0YXR1c0NvZGUgPT0gMjAwKSB7DQogICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsDQogICAgICAgICAgICBtZXNzYWdlOiAi5Yig6Zmk5YWs5ZGK5oiQ5YqfIiwNCiAgICAgICAgICB9KTsNCiAgICAgICAgICB0aGlzLmdldEFubm91bmNlbWVudHNMaXN0KCkNCiAgICAgICAgfQ0KICAgICAgfSkuY2F0Y2goKCkgPT4gew0KICAgICAgICAvLyB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgLy8gICB0eXBlOiAnaW5mbycsDQogICAgICAgIC8vICAgbWVzc2FnZTogJ+W3suWPlua2iOWIoOmZpCcNCiAgICAgICAgLy8gfSk7DQogICAgICB9KQ0KICAgIH0sDQogICAgc2hvd0RpYWxvZyAoZmxhZywgZGF0YSkgew0KICAgICAgaWYgKGZsYWcgPT0gJ2RldGFpbCcpIHsNCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goew0KICAgICAgICAgIHBhdGg6ICcvYW5ub3VuY2VtZW50c0RldGlsJywNCiAgICAgICAgICBxdWVyeTogew0KICAgICAgICAgICAgZGF0YXM6IGRhdGENCiAgICAgICAgICB9LA0KICAgICAgICB9KQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kcmVmcy5lZGl0LnNob3dEaWFsb2coZmxhZywgZGF0YSkNCiAgICAgIH0NCg0KDQogICAgfSwNCiAgICAvL+iuoeeul3RhYmxl55qE6auY5bqmDQogICAgaW5pdFRhYmxlSGVpZ2h0ICgpIHsNCiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgbGV0IGF2YWlsSGVpZ2h0ID0gd2luZG93LnNjcmVlbi5hdmFpbEhlaWdodDsgLy/pobXpnaLlj6/op4bljJbpq5jluqYNCiAgICAgICAgdmFyIGVsUGFnZUNsaWVudEhlaWdodCA9IHRoaXMuJHJlZnMuZWxQYWdlPy4kZWw/LmNsaWVudEhlaWdodCB8fCAwOyAvLyDliIbpobXlmajpq5jluqYNCiAgICAgICAgdGhpcy50YWJsZUhlaWdodCA9DQogICAgICAgICAgYXZhaWxIZWlnaHQgLSBlbFBhZ2VDbGllbnRIZWlnaHQgLSAzODA7DQogICAgICB9KTsNCiAgICB9LA0KICAgIC8vIOWIhumhteW9k+WJjemhteWPmOWMluWbnuiwgw0KICAgIGFzeW5jIGNoYW5nZVBhZ2UgKHBhZ2UpIHsNCiAgICAgIHRoaXMuZm9ybS5QYWdlTnVtYmVyID0gcGFnZQ0KICAgICAgdGhpcy5nZXRMaXN0SW5mbygpDQogICAgfSwNCiAgICBoYW5kbGVTaXplQ2hhbmdlIChkYXRhKSB7DQogICAgICB0aGlzLmZvcm0uUGFnZVNpemUgPSBkYXRhDQogICAgICB0aGlzLmdldExpc3RJbmZvKCkNCiAgICB9DQogIH0sDQoNCg0KDQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA","file":"index.vue","sourceRoot":"src/views/systemManagement/announcementManagement","sourcesContent":["<template>\r\n  <div class=\"box\">\r\n    <div class=\"room\">\r\n      <el-form :model=\"form\" ref=\"form\" size=\"small\" :inline=\"true\" v-show=\"showSearch\" label-width=\"80px\" class=\"form_row\">\r\n        <el-row>\r\n          <el-col :span=\"6\">\r\n            <el-form-item label=\"公告标题:\" prop=\"Name\">\r\n              <el-input v-model=\"form.Title\" placeholder=\"请输入标题关键字\"></el-input>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"4\">\r\n            <!-- <el-button class=\"searchBtn Btn\" type=\"primary\" @click=\"searchList\">搜索</el-button> -->\r\n            <!-- <el-button class=\"searchBtn Btn\" type=\"primary\" round @click=\"searchList\">\r\n\t\t\t\t\t<i class=\"el-icon-search searchBtnicon\"></i>\r\n\t\t\t\t\t搜索\r\n\t\t\t\t</el-button> -->\r\n            <!-- <el-button @click=\"searchList\" type=\"primary\" style=\"margin-left: 10px\">查询</el-button> -->\r\n            <!-- <el-button type=\"primary\" @click=\"showDialog('newann')\"></el-button> -->\r\n            <div class=\"searchbox\">\r\n              <div class=\"searchBtn\" @click=\"searchList\">\r\n                <img class=\"Btnicon\" src=\"@/assets/images/searchicon2.png\" alt=\"\" />\r\n                查询\r\n              </div>\r\n              <div class=\"ResetBtn\" style=\"margin-left: 10px\" @click=\"resetBtn\">\r\n                <img class=\"Btnicon\" src=\"@/assets/images/reseticon.svg\" alt=\"\" />\r\n                重置\r\n              </div>\r\n            </div>\r\n          </el-col>\r\n        </el-row>\r\n      </el-form>\r\n      <div class=\"butt\">\r\n        <div class=\"buttbox\">\r\n          <el-row :gutter=\"15\">\r\n            <el-col :span=\"1.5\">\r\n              <el-button class=\"addBtn Btn\" round type=\"primary\" @click=\"showDialog('newann')\">\r\n                <img class=\"addBtnimg\" src=\"../../../assets/images/addbtnicon.svg\" alt=\"\" />\r\n                新增\r\n              </el-button>\r\n            </el-col>\r\n          </el-row>\r\n        </div>\r\n      </div>\r\n      <!-- 列表展示区 -->\r\n      <div>\r\n        <vxe-table :data=\"searchResult\" :height=\"tableHeight\" align=\"center\" border class=\"mytable-scrollbar\">\r\n          <vxe-column field=\"AnnouncementType'\" title=\"公告类型\" width=\"150\">\r\n            <template slot-scope=\"scope\">\r\n              <div>{{ scope.row.AnnouncementType == 1 ? '公告' : '活动' }}</div>\r\n            </template>\r\n          </vxe-column>\r\n          <vxe-column field=\"AnnouncementDate\" title=\"公告日期\" width=\"200\">\r\n            <template slot-scope=\"{ row }\">\r\n              <span>\r\n                {{ row.AnnouncementDate | parseTime('{y}-{m}-{d}') }}\r\n              </span>\r\n            </template>\r\n          </vxe-column>\r\n          <vxe-column field=\"Title\" title=\"公告标题\" width=\"322\"></vxe-column>\r\n          <vxe-column field=\"ViewRangeName\" title=\"查看范围\"></vxe-column>\r\n          <vxe-column field=\"Remarks\" title=\"备注\"></vxe-column>\r\n          <vxe-column title=\"操作\" width=\"150\" align=\"center\">\r\n            <template slot-scope=\"scope\">\r\n              <div class=\"flex_center\">\r\n                <el-link type=\"primary\" @click=\"showDialog('modifyann', scope.row)\">修改</el-link>\r\n                <div class=\"Divider\"></div>\r\n                <el-link type=\"primary\" @click=\"showDialog('detail', scope.row)\">详情</el-link>\r\n                <div class=\"Divider\"></div>\r\n                <el-link type=\"primary\" @click=\"delAnnouncement(scope.row)\">删除</el-link>\r\n              </div>\r\n            </template>\r\n          </vxe-column>\r\n        </vxe-table>\r\n      </div>\r\n      <!-- 分页器 -->\r\n      <div class=\"app-pagination\">\r\n        <el-pagination\r\n          ref=\"elPage\"\r\n          :current-page=\"form.CurrentPage\"\r\n          :total=\"form.TotalCount\"\r\n          @current-change=\"changePage\"\r\n          @size-change=\"handleSizeChange\"\r\n          :page-sizes=\"[10, 20, 30, 40, 50, 100]\"\r\n          :page-size=\"form.PageSize\"\r\n          layout=\"total,sizes,prev, pager, next, jumper\"\r\n        ></el-pagination>\r\n      </div>\r\n      <!-- 弹框 -->\r\n      <Edit ref=\"edit\" @suimte=\"getAnnouncementsList\"></Edit>\r\n      <!-- </div> -->\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\n// 字典\r\nimport {\r\n  usedictionarydetails\r\n} from '@/api/dict.js'\r\nimport Edit from \"@/views/systemManagement/announcementManagement/edit.vue\"\r\n// api\r\nimport {\r\n  getAnnouncements,\r\n  addOrUpdataAnnouncements,\r\n  delAnnouncements,\r\n  updataAnnounce\r\n} from '@/api/annoucement'\r\nexport default {\r\n  name: 'AnnouncementManagement',\r\n  components: {\r\n    Edit\r\n  },\r\n  data () {\r\n    return {\r\n      title: \"\",\r\n      keyword: '',\r\n      flag: '',\r\n      A0032: [],\r\n      A0033: [],\r\n      announcementList: [],\r\n      announcementtable: [],\r\n      dialogFormVisible: false,\r\n      showSearch: true,\r\n      form: {\r\n        // 登录缓存中获取的派发参数\r\n        AnnouncementId: JSON.parse(localStorage.getItem('userInfo')).userId,\r\n        CurrentPage: 1,\r\n        PageSize: 10,\r\n        TotalPages: 0,\r\n      },\r\n      tableHeight: \"300\", //table高度\r\n      searchResult: []\r\n    }\r\n  },\r\n  created () {\r\n\r\n  },\r\n  mounted () {\r\n    this.getAnnouncementsList()\r\n    this.initTableHeight();\r\n  },\r\n  // computed: {\r\n  //   searchResult() {\r\n  //     if (this.keyword) {\r\n  //       return this.announcementList.filter((item) => {\r\n  //         return item.Content.indexOf(this.keyword) !== -1\r\n  //       })\r\n  //     } else {\r\n  //       return this.announcementList;\r\n  //     }\r\n  //   },\r\n  // },\r\n\r\n  methods: {\r\n    // 获取数据\r\n    getAnnouncementsList () {\r\n      getAnnouncements(this.form).then((res) => {\r\n        this.announcementList = [...res.Response.items];\r\n        this.searchResult = [...res.Response.items];\r\n        Object.assign(this.form, res.Response);\r\n      })\r\n    },\r\n    // 搜索\r\n    searchList () {\r\n      this.getAnnouncementsList()\r\n    },\r\n    //重置\r\n    resetBtn () {\r\n      this.form.Title = '';\r\n      this.getAnnouncementsList()\r\n    },\r\n    // 删除\r\n    async delAnnouncement (data) {\r\n      this.$confirm(`确认要删除这条数据吗?`, \"删除\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"error\",\r\n        roundButton:true,\r\n      }).then(async () => {\r\n        let op = [data.AnnouncementId]\r\n        let res = await delAnnouncements(op)\r\n        if (res.StatusCode == 200) {\r\n          this.$message({\r\n            type: \"success\",\r\n            message: \"删除公告成功\",\r\n          });\r\n          this.getAnnouncementsList()\r\n        }\r\n      }).catch(() => {\r\n        // this.$message({\r\n        //   type: 'info',\r\n        //   message: '已取消删除'\r\n        // });\r\n      })\r\n    },\r\n    showDialog (flag, data) {\r\n      if (flag == 'detail') {\r\n        this.$router.push({\r\n          path: '/announcementsDetil',\r\n          query: {\r\n            datas: data\r\n          },\r\n        })\r\n      } else {\r\n        this.$refs.edit.showDialog(flag, data)\r\n      }\r\n\r\n\r\n    },\r\n    //计算table的高度\r\n    initTableHeight () {\r\n      this.$nextTick(() => {\r\n        let availHeight = window.screen.availHeight; //页面可视化高度\r\n        var elPageClientHeight = this.$refs.elPage?.$el?.clientHeight || 0; // 分页器高度\r\n        this.tableHeight =\r\n          availHeight - elPageClientHeight - 380;\r\n      });\r\n    },\r\n    // 分页当前页变化回调\r\n    async changePage (page) {\r\n      this.form.PageNumber = page\r\n      this.getListInfo()\r\n    },\r\n    handleSizeChange (data) {\r\n      this.form.PageSize = data\r\n      this.getListInfo()\r\n    }\r\n  },\r\n\r\n\r\n\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>\r\n"]}]}