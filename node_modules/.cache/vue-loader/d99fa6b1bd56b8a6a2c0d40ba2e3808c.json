{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\patientManagement\\patientManagement\\components\\tabComponents\\echeatComponents\\calendarTime.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\patientManagement\\patientManagement\\components\\tabComponents\\echeatComponents\\calendarTime.vue","mtime":1678931188658},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678931310818},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\babel-loader\\lib\\index.js","mtime":1678931314285},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678931310818},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js","mtime":1678931316857}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgew0KICBwdWxtb25hcnltZWRpY2luZXN0aW1lDQp9IGZyb20gJ0AvYXBpL1B1bG1vbmFyeU1lZGljaW5lLmpzJw0KZXhwb3J0IGRlZmF1bHQgew0KICAvLyDmjqXmlLblj4LmlbBJRA0KICBwcm9wczogWydkaWFnbm9zaXNJZCcsICd0YWJsZURhdGEnXSwNCiAgZGF0YSAoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHZhbHVlOiBuZXcgRGF0ZSgpLA0KICAgICAgcmVzcG9uc2U6IHt9LA0KICAgICAgb2JqOiB7DQogICAgICAgIHN0YXJ0dGltZTogJycsDQogICAgICAgIGVuZHRpbWU6ICcnDQogICAgICB9DQogICAgfQ0KICB9LA0KICB3YXRjaDogew0KICAgIHZhbHVlOiB7DQogICAgICBoYW5kbGVyIChuZXdWYWx1ZSwgb2xkVmFsdWUpIHsNCiAgICAgICAgdGhpcy5mdW5wdWxtb25hcnltZWRpY2luZXN0aW1lKCkNCiAgICAgIH0sDQogICAgfSwNCiAgICBkaWFnbm9zaXNJZDogZnVuY3Rpb24gKHZhbCkgew0KICAgICAgdGhpcy5mdW5wdWxtb25hcnltZWRpY2luZXN0aW1lKCkNCiAgICB9LA0KICAgIHRhYmxlRGF0YTogZnVuY3Rpb24gKHZhbCkgew0KICAgICAgdGhpcy5mdW5wdWxtb25hcnltZWRpY2luZXN0aW1lKCkNCiAgICB9LA0KICB9LA0KICBjcmVhdGVkICgpIHsNCiAgICB0aGlzLmZ1bnB1bG1vbmFyeW1lZGljaW5lc3RpbWUoKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLy8g5aSE55CG5pe26Ze05qC85byP55qE5pa55rOVDQogICAgZm9ybURhdGUgKGRhdGEsIGZvcm1hdCA9ICJ5eXl5LU1NLUREIikgew0KICAgICAgbGV0IHRpbWUgPSBkYXRhID8gew0KICAgICAgICAiTSsiOiBkYXRhLmdldE1vbnRoKCkgKyAxLA0KICAgICAgICAiRCsiOiBkYXRhLmdldERhdGUoKSwNCiAgICAgICAgIkgrIjogZGF0YS5nZXRIb3VycygpLA0KICAgICAgICAibSsiOiBkYXRhLmdldE1pbnV0ZXMoKSwNCiAgICAgICAgInMrIjogZGF0YS5nZXRTZWNvbmRzKCksDQogICAgICB9IDoge30NCg0KICAgICAgaWYgKC8oeSspL2kudGVzdChmb3JtYXQpKSB7DQogICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKA0KICAgICAgICAgIFJlZ0V4cC4kMSwNCiAgICAgICAgICAoZGF0YSAmJiAoZGF0YS5nZXRGdWxsWWVhcigpICsgIiIpKS5zdWJzdHIoNCAtIFJlZ0V4cC4kMS5sZW5ndGgpDQogICAgICAgICk7DQogICAgICB9DQoNCiAgICAgIGZvciAobGV0IGsgaW4gdGltZSkgew0KICAgICAgICBpZiAobmV3IFJlZ0V4cCgiKCIgKyBrICsgIikiKS50ZXN0KGZvcm1hdCkpIHsNCiAgICAgICAgICBmb3JtYXQgPSBmb3JtYXQucmVwbGFjZSgNCiAgICAgICAgICAgIFJlZ0V4cC4kMSwNCiAgICAgICAgICAgIFJlZ0V4cC4kMS5sZW5ndGggPT09IDEgPw0KICAgICAgICAgICAgICB0aW1lW2tdIDoNCiAgICAgICAgICAgICAgKCIwMCIgKyB0aW1lW2tdKS5zdWJzdHIoKCIiICsgdGltZVtrXSkubGVuZ3RoKQ0KICAgICAgICAgICk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHJldHVybiBmb3JtYXQ7DQogICAgfSwNCg0KICAgIC8v6I635Y+W5b2T5pyI5pe26Ze05Yid5aeL5pe26Ze0K+agvOW8j+WMlg0KICAgIElkVGltZWZ1biAoKSB7DQogICAgICAvLyDlvZPmnIjnrKzkuIDlpKkw54K5DQogICAgICBsZXQgZm9tYXRWYWx1ZSA9IG5ldyBEYXRlKHRoaXMuZm9ybURhdGUodGhpcy52YWx1ZSkpOw0KICAgICAgZm9tYXRWYWx1ZS5zZXREYXRlKDEpOw0KICAgICAgZm9tYXRWYWx1ZS5zZXRIb3VycygwKTsNCiAgICAgIGZvbWF0VmFsdWUuc2V0U2Vjb25kcygwKTsNCiAgICAgIGZvbWF0VmFsdWUuc2V0TWludXRlcygwKTsNCiAgICAgIC8vIGRhdGEuZ2V0VGltZSgpIOaciOWInTDngrnml7bpl7TmiLMNCg0KICAgICAgbGV0IE9uZWRheSA9IHRoaXMuZm9ybURhdGUobmV3IERhdGUoZm9tYXRWYWx1ZS5nZXRUaW1lKCkpLCAieXl5eS1NTS1ERCBISDptbTpzcyIpOw0KDQoNCiAgICAgIGlmIChmb21hdFZhbHVlICYmIGZvbWF0VmFsdWUuZ2V0TW9udGgoKSA9PT0gMTEpIHsNCiAgICAgICAgZm9tYXRWYWx1ZS5zZXRNb250aCgwKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGZvbWF0VmFsdWUuc2V0TW9udGgoZm9tYXRWYWx1ZSAmJiBmb21hdFZhbHVlLmdldE1vbnRoKCkgKyAxKTsNCiAgICAgIH0NCiAgICAgIGZvbWF0VmFsdWUuc2V0RGF0ZSgxKTsNCiAgICAgIGZvbWF0VmFsdWUuc2V0SG91cnMoMCk7DQogICAgICBmb21hdFZhbHVlLnNldFNlY29uZHMoMCk7DQogICAgICBmb21hdFZhbHVlLnNldE1pbnV0ZXMoMCk7DQogICAgICBjb25zdCB0aW1lRW5kID0gKHBhcnNlSW50KGZvbWF0VmFsdWUuZ2V0VGltZSgpIC8gMTAwMCkgLSAxKSAqIDEwMDA7DQogICAgICAvLyB0aW1lRW5kIOaciOacqzExOjU55pe26Ze05oizDQogICAgICBsZXQgRW5kZGF5ID0gdGhpcy5mb3JtRGF0ZShuZXcgRGF0ZSh0aW1lRW5kKSwgInl5eXktTU0tREQgSEg6bW06c3MiKQ0KICAgICAgcmV0dXJuIFtPbmVkYXksIEVuZGRheV0NCiAgICB9LA0KICAgIGdldGZpcnN0RGF0ZUFuZGxhc3REYXRlICgpIHsNCiAgICAgIHZhciBkYXRlU3RyID0gdGhpcy52YWx1ZTsNCiAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZVN0cik7DQogICAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTsNCiAgICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSArIDE7DQogICAgICBpZiAobW9udGggPiAxMikgew0KICAgICAgICBtb250aCA9IDE7DQogICAgICAgIHllYXIrKzsNCiAgICAgIH0NCiAgICAgIGlmIChtb250aCA8IDEwKSB7DQogICAgICAgIG1vbnRoID0gJzAnICsgbW9udGgNCiAgICAgIH0NCiAgICAgIHZhciBtb250aExhc3REYXkgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMCkuZ2V0RGF0ZSgpOw0KICAgICAgdmFyIGZpcnN0RGF0ZSA9IHllYXIgKyAnLScgKyBtb250aCArICctJyArICcwMSc7DQogICAgICB2YXIgbGFzdERhdGUgPSB5ZWFyICsgJy0nICsgbW9udGggKyAnLScgKyBtb250aExhc3REYXk7DQogICAgICByZXR1cm4gW2ZpcnN0RGF0ZSwgbGFzdERhdGVdDQogICAgfSwNCiAgICAvL+ivt+axguaVsOaNrg0KICAgIGFzeW5jIGZ1bnB1bG1vbmFyeW1lZGljaW5lc3RpbWUgKCkgew0KICAgICAgbGV0IHN0YXJ0RGF0ZSA9IHRoaXMuZ2V0Zmlyc3REYXRlQW5kbGFzdERhdGUoKVswXQ0KICAgICAgbGV0IGVuZERhdGUgPSB0aGlzLmdldGZpcnN0RGF0ZUFuZGxhc3REYXRlKClbMV0NCiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHB1bG1vbmFyeW1lZGljaW5lc3RpbWUodGhpcy5kaWFnbm9zaXNJZCwgc3RhcnREYXRlLCBlbmREYXRlKQ0KICAgICAgdGhpcy4kYnVzLiRlbWl0KCdtZWRpY2luZScsIHJlcy5SZXNwb25zZSkNCiAgICAgIC8v5pyN6I2v5pel5Y6GIC5NZWRpY2F0aW9uQ2FsZW5kYXJzDQogICAgICB0aGlzLnJlc3BvbnNlID0gcmVzLlJlc3BvbnNlDQoNCiAgICB9LA0KDQoNCg0KICB9DQp9DQo="},{"version":3,"sources":["calendarTime.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;AAIA;AACA","file":"calendarTime.vue","sourceRoot":"src/views/patientManagement/patientManagement/components/tabComponents/echeatComponents","sourcesContent":["<template>\r\n  <div id=\"map\">\r\n    <!-- <h1>111{{diagnosisId}}</h1> -->\r\n    <el-calendar v-model=\"value\">\r\n      <template slot=\"dateCell\" slot-scope=\"{ date, data }\">\r\n        <span style=\"position: relative\">\r\n          {{ data.day.split('-').slice(2).join('') }}\r\n          <span v-for=\"item in response.MedicationCalendars\">\r\n            <span v-if=\"item.date.indexOf(data.day.split('-').slice(1).join('-')) != -1\">\r\n              <!-- {{item.MedicationSituation}} -->\r\n              <div v-if=\"item.MedicationSituation == 0\" class=\"abnormal\"></div>\r\n              <!-- 未服药 -->\r\n              <div v-if=\"item.MedicationSituation == 1\" class=\"normal\"></div>\r\n              <!-- 已服药 -->\r\n              <div v-if=\"item.MedicationSituation == 2\" class=\"nonormal\" style=\"\"></div>\r\n              <!-- 不规则服药 -->\r\n              <!-- <div v-if=\"item.MedicationSituation == 4\" class=\"future\" style=\"\"></div> -->\r\n              <!-- 未来服药不显示样式 -->\r\n            </span>\r\n          </span>\r\n        </span>\r\n      </template>\r\n    </el-calendar>\r\n    <div class=\"tiptitle\">\r\n      <div class=\"abnormal\"></div>\r\n      <div style=\"margin-left: 5px\">未服药</div>\r\n      <div class=\"normal\"></div>\r\n      <div style=\"margin-left: 5px\">已服药</div>\r\n      <div class=\"nonormal\"></div>\r\n      <div style=\"margin-left: 5px\">服药异常</div>\r\n      <!-- <div class=\"future\"></div>\r\n      <div style=\"margin-left: 2px\">未来服药</div> -->\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  pulmonarymedicinestime\r\n} from '@/api/PulmonaryMedicine.js'\r\nexport default {\r\n  // 接收参数ID\r\n  props: ['diagnosisId', 'tableData'],\r\n  data () {\r\n    return {\r\n      value: new Date(),\r\n      response: {},\r\n      obj: {\r\n        starttime: '',\r\n        endtime: ''\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    value: {\r\n      handler (newValue, oldValue) {\r\n        this.funpulmonarymedicinestime()\r\n      },\r\n    },\r\n    diagnosisId: function (val) {\r\n      this.funpulmonarymedicinestime()\r\n    },\r\n    tableData: function (val) {\r\n      this.funpulmonarymedicinestime()\r\n    },\r\n  },\r\n  created () {\r\n    this.funpulmonarymedicinestime()\r\n  },\r\n  methods: {\r\n    // 处理时间格式的方法\r\n    formDate (data, format = \"yyyy-MM-DD\") {\r\n      let time = data ? {\r\n        \"M+\": data.getMonth() + 1,\r\n        \"D+\": data.getDate(),\r\n        \"H+\": data.getHours(),\r\n        \"m+\": data.getMinutes(),\r\n        \"s+\": data.getSeconds(),\r\n      } : {}\r\n\r\n      if (/(y+)/i.test(format)) {\r\n        format = format.replace(\r\n          RegExp.$1,\r\n          (data && (data.getFullYear() + \"\")).substr(4 - RegExp.$1.length)\r\n        );\r\n      }\r\n\r\n      for (let k in time) {\r\n        if (new RegExp(\"(\" + k + \")\").test(format)) {\r\n          format = format.replace(\r\n            RegExp.$1,\r\n            RegExp.$1.length === 1 ?\r\n              time[k] :\r\n              (\"00\" + time[k]).substr((\"\" + time[k]).length)\r\n          );\r\n        }\r\n      }\r\n      return format;\r\n    },\r\n\r\n    //获取当月时间初始时间+格式化\r\n    IdTimefun () {\r\n      // 当月第一天0点\r\n      let fomatValue = new Date(this.formDate(this.value));\r\n      fomatValue.setDate(1);\r\n      fomatValue.setHours(0);\r\n      fomatValue.setSeconds(0);\r\n      fomatValue.setMinutes(0);\r\n      // data.getTime() 月初0点时间戳\r\n\r\n      let Oneday = this.formDate(new Date(fomatValue.getTime()), \"yyyy-MM-DD HH:mm:ss\");\r\n\r\n\r\n      if (fomatValue && fomatValue.getMonth() === 11) {\r\n        fomatValue.setMonth(0);\r\n      } else {\r\n        fomatValue.setMonth(fomatValue && fomatValue.getMonth() + 1);\r\n      }\r\n      fomatValue.setDate(1);\r\n      fomatValue.setHours(0);\r\n      fomatValue.setSeconds(0);\r\n      fomatValue.setMinutes(0);\r\n      const timeEnd = (parseInt(fomatValue.getTime() / 1000) - 1) * 1000;\r\n      // timeEnd 月末11:59时间戳\r\n      let Endday = this.formDate(new Date(timeEnd), \"yyyy-MM-DD HH:mm:ss\")\r\n      return [Oneday, Endday]\r\n    },\r\n    getfirstDateAndlastDate () {\r\n      var dateStr = this.value;\r\n      var date = new Date(dateStr);\r\n      var year = date.getFullYear();\r\n      var month = date.getMonth() + 1;\r\n      if (month > 12) {\r\n        month = 1;\r\n        year++;\r\n      }\r\n      if (month < 10) {\r\n        month = '0' + month\r\n      }\r\n      var monthLastDay = new Date(year, month, 0).getDate();\r\n      var firstDate = year + '-' + month + '-' + '01';\r\n      var lastDate = year + '-' + month + '-' + monthLastDay;\r\n      return [firstDate, lastDate]\r\n    },\r\n    //请求数据\r\n    async funpulmonarymedicinestime () {\r\n      let startDate = this.getfirstDateAndlastDate()[0]\r\n      let endDate = this.getfirstDateAndlastDate()[1]\r\n      const res = await pulmonarymedicinestime(this.diagnosisId, startDate, endDate)\r\n      this.$bus.$emit('medicine', res.Response)\r\n      //服药日历 .MedicationCalendars\r\n      this.response = res.Response\r\n\r\n    },\r\n\r\n\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n#map {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: relative;\r\n}\r\n\r\n::v-deep .el-calendar-table .el-calendar-day {\r\n  height: 37px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.abnormal {\r\n  background-color: #ff4323;\r\n  width: 8px;\r\n  height: 8px;\r\n  border-radius: 8px;\r\n  margin-left: 5px;\r\n}\r\n\r\n.normal {\r\n  background-color: #46d4a4;\r\n  width: 8px;\r\n  height: 8px;\r\n  border-radius: 8px;\r\n  margin-left: 5px;\r\n}\r\n\r\n.future {\r\n  background-color: #252d57;\r\n  width: 8px;\r\n  height: 8px;\r\n  border-radius: 8px;\r\n  margin-left: 5px;\r\n}\r\n\r\n.nonormal {\r\n  background-color: #ff23f7;\r\n  width: 8px;\r\n  height: 8px;\r\n  border-radius: 8px;\r\n  margin-left: 5px;\r\n}\r\n\r\n.tiptitle {\r\n  display: flex;\r\n  align-items: center;\r\n\r\n  position: absolute;\r\n  left: 18%;\r\n  z-index: 1;\r\n  top: 4%;\r\n}\r\n</style>\r\n"]}]}