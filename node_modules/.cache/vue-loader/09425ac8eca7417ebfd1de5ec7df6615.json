{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\patientManagement\\unassignedrecord\\components\\tabComponents\\follow-uptab10.vue?vue&type=style&index=0&id=c33043f8&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\patientManagement\\unassignedrecord\\components\\tabComponents\\follow-uptab10.vue","mtime":1678931188690},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\css-loader\\dist\\cjs.js","mtime":1678931311747},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1678931317953},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\postcss-loader\\src\\index.js","mtime":1678931314216},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1678931310798},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678931310818},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js","mtime":1678931316857}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5yb29tMiB7DQogIHdpZHRoOiAxMDAlOw0KICBoZWlnaHQ6IDEwMCU7DQogIC8vIG92ZXJmbG93OiBoaWRkZW47DQoNCn0NCg0KLmhlYXJkIHsNCiAgd2lkdGg6IDEwMCU7DQogIC8vIGJhY2tncm91bmQ6cmVkOw0KICBoZWlnaHQ6IDM1MHB4Ow0KICBkaXNwbGF5OiBmbGV4Ow0KfQ0KDQouZWNoYXJ0Um9vbSB7DQogIHdpZHRoOiA0MCU7DQogIGhlaWdodDogMTAwJTsNCiAgLy8gZmxvYXQ6IGxlZnQ7DQoNCn0NCg0KLmVjaGFydFJvb20+cCB7DQogIGNvbG9yOiBibGFjazsNCiAgZm9udC1zaXplOiAyNVBYOw0KICBmb250LXdlaWdodDogNjAwOw0KICBtYXJnaW46IDE1cHggMCAwIDIwcHg7DQp9DQoNCi5jYWxlbmRhciB7DQogIHdpZHRoOiA2MCU7DQogIGhlaWdodDogMTAwJTsNCiAgYmFja2dyb3VuZDogcmdiKDIxOSwgMjI4LCAxNzMpOw0KICAvLyBmbG9hdDogbGVmdDsNCg0KfQ0KDQoudGFibGVib3ggew0KICB3aWR0aDogMTAwJTsNCiAgaGVpZ2h0OiA3NSU7DQogIGZsb2F0OiBsZWZ0Ow0KICBtYXJnaW4tdG9wOiAxMHB4Ow0KfQ0KDQouZWwtYnV0dG9uLS1tZWRpdW0uaXMtcm91bmQgew0KICBtYXJnaW4tdG9wOiAzMHB4Ow0KICBtYXJnaW4tbGVmdDogOTAlOw0KfQ0KDQouZmxleF9jZW50ZXIgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBtYXJnaW46IDAgYXV0bzsNCn0NCg=="},{"version":3,"sources":["follow-uptab10.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+SA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"follow-uptab10.vue","sourceRoot":"src/views/patientManagement/patientManagement/components/tabComponents","sourcesContent":["<template>\r\n  <div class=\"room2\">\r\n    <el-button :disabled=\"inputData.IsClosed ? true : false\" type=\"primary\" v-if=\"tableData.length== 0\" round @click.native=\"handlerEdit('addfollow')\">新增随访\r\n    </el-button>\r\n    <el-button :disabled=\"inputData.IsClosed ? true : false\" type=\"primary\" v-if=\"tableData.length!== 0\" round @click.native=\"handlerEdit2('addfollow')\">后续随访\r\n    </el-button>\r\n    <!-- 表格 -->\r\n    <div class=\"tablebox\">\r\n      <vxe-table auto-resize border height=\"500\" align=\"center\" show-header-overflow show-overflow :row-config=\"{ isHover: true }\"\r\n        :data=\"tableData\">\r\n        <!-- <vxe-column field=\"DiagnosisTime\" title=\"确诊时间\"></vxe-column> -->\r\n        <!-- <vxe-column field=\"ResponsibilityName\" title=\"责任医生\"></vxe-column> -->\r\n        <!-- <vxe-column field=\"AdminOrganizationName\" title=\"管理机构\"></vxe-column> -->\r\n        <vxe-column field=\"VisitDoctorName\" title=\"随访医生\"></vxe-column>\r\n        <vxe-column field=\"VisitOrganizationName\" title=\"随访机构\"></vxe-column>\r\n\r\n        <vxe-column field=\"VisitType\" title=\"随访类型\">\r\n          <template #default=\"{ row }\">\r\n            <el-link :underline=\"false\"  v-if=\"row.VisitType == 1\">初次随访 \r\n            </el-link>\r\n            <el-link :underline=\"false\"  v-if=\"row.VisitType == 2\">后续随访\r\n            </el-link>\r\n          </template>\r\n        </vxe-column>\r\n        <vxe-column field=\"VisitDate\" title=\"随访日期\">\r\n          <template slot-scope=\"{ row }\">\r\n            <span>\r\n              {{ row.VisitDate | parseTime(\"{y}-{m}-{d}\") }}\r\n            </span>\r\n          </template>\r\n\r\n        </vxe-column>\r\n        <vxe-column field=\"NextVisitDate\" title=\"下次随访日期\">\r\n          <template slot-scope=\"{ row }\">\r\n            <span>\r\n              {{ row.NextVisitDate | parseTime(\"{y}-{m}-{d}\") }}\r\n            </span>\r\n          </template>\r\n        </vxe-column>\r\n\r\n        <vxe-column field=\"SymptomDesc\" title=\"症状\"></vxe-column>\r\n        <vxe-column title=\"操作\" width=\"180\">\r\n          <template #default=\"{ row }\">\r\n            <div class=\"flex_center \">\r\n              <!-- <el-link type=\"primary\" @click=\"handlerEdit2('addfollow', row)\">新增后续随访</el-link> -->\r\n              <el-link type=\"primary\" v-if=\"row.VisitType == 1\" @click=\"handlerEdit('details', row)\">详情</el-link>\r\n              <div class=\"Divider\" v-if=\"row.VisitType == 1\"></div>\r\n              <el-link type=\"warning\" :disabled=\"inputData.IsClosed ? true : false\" v-if=\"row.VisitType == 1\" @click=\"handlerEdit('Modify', row)\">修改</el-link>\r\n              <div class=\"Divider\" v-if=\"row.VisitType == 1\"></div>\r\n              <el-link type=\"danger\" v-if=\"row.VisitType == 1\" @click=\"handlerEdit('delete', row)\">删除</el-link>\r\n              <!-- 2次随访 -->\r\n              <el-link type=\"primary\" v-if=\"row.VisitType == 2\" @click=\"handlerEdit2('details', row)\">详情</el-link>\r\n              <div class=\"Divider\" v-if=\"row.VisitType == 2\"></div>\r\n              <el-link type=\"warning\" :disabled=\"inputData.IsClosed ? true : false\" v-if=\"row.VisitType == 2\" @click=\"handlerEdit2('Modify', row)\">修改</el-link>\r\n              <div class=\"Divider\" v-if=\"row.VisitType == 2\"></div>\r\n              <el-link type=\"danger\" v-if=\"row.VisitType == 2\" @click=\"handlerEdit2('delete', row)\">删除</el-link>\r\n            </div>\r\n          </template>\r\n        </vxe-column>\r\n      </vxe-table>\r\n    </div>\r\n    <FollowupEdit ref=\"followupEdit\" @submit=\"funPulmonaryVisitlist\"></FollowupEdit>\r\n    <FollowupEdit2 ref=\"followupEdit2\" @submit=\"funPulmonaryVisitlist\"></FollowupEdit2>\r\n    <XqfollowEdit ref=\"xqfollowEdit\"></XqfollowEdit>\r\n    <XqfollowEdit2 ref=\"xqfollowEdit2\"></XqfollowEdit2>\r\n  </div>\r\n</template>\r\n<script>\r\n\r\n\r\n// 随访弹窗\r\nimport FollowupEdit from './echeatComponents/follow-upEdit.vue'\r\n// 后续随访\r\nimport FollowupEdit2 from './echeatComponents/follow-upEdit2.vue'\r\n// 详情\r\nimport XqfollowEdit from './EditComponents/xqfollowEdit.vue'\r\nimport XqfollowEdit2 from './EditComponents/xqfollowEdit2.vue'\r\nimport {\r\n  pulmonarybadreactionslist,\r\n  pulmonarybadreactionsupdate,\r\n  pulmonarybadreactionsdelete,\r\n  pulmonarybadreactionsdetails\r\n} from '@/api/PulmonaryFirstVisit.js'\r\n\r\nimport {\r\n  PulmonaryPatientVisitlist,\r\n  PulmonaryPatientVisitdetails,\r\n  PulmonaryPatientVisitupdate,\r\n  PulmonaryPatientVisitdelete\r\n} from \"@/api/PulmonaryPatientVisit\";\r\n\r\nimport { PulmonaryVisitlist } from '@/api/PulmonaryVisit.js'\r\nexport default {\r\n  components: { FollowupEdit, FollowupEdit2, XqfollowEdit, XqfollowEdit2 },\r\n  props: ['inputData'],\r\n  data() {\r\n    return {\r\n      form: {},\r\n      tableData: [],\r\n      copyData: [{}]\r\n    }\r\n\r\n  },\r\n  async created() {\r\n    this.copyData[0] = this.inputData,\r\n      await this.funPulmonaryVisitlist()\r\n  },\r\n\r\n  methods: {\r\n    // 初次随访\r\n    async handlerEdit(flag, data, formdata) {\r\n      if (flag == 'addfollow') {\r\n        let lengths = this.tableData.length\r\n        if (lengths == 0) {\r\n          this.$refs.followupEdit.show(flag,this.inputData)\r\n        } else {\r\n          this.$baseMessage('已存在初次预约随访', \"error\")\r\n        }\r\n      } else if (flag == 'details') {\r\n        // 详情\r\n        const res = await pulmonarybadreactionsdetails({ firstVisitId: data.VisitId })\r\n        let { StatusCode, Message } = res;\r\n        if (StatusCode != 200) {\r\n          return this.$baseMessage(\r\n            Message || '数据获取失败', 'error'\r\n          )\r\n        }\r\n        formdata = res.Response\r\n        this.$refs.xqfollowEdit.show(flag, data, formdata)\r\n      } else if (flag == 'Modify') {\r\n        // 修改（先获取详情）\r\n        const res = await pulmonarybadreactionsdetails({ firstVisitId: data.VisitId })\r\n        let { StatusCode, Message } = res;\r\n        if (StatusCode != 200) {\r\n          return this.$baseMessage(\r\n            Message || '数据获取失败', 'error'\r\n          )\r\n        }\r\n        formdata = res.Response\r\n        formdata.Symptom = formdata.Symptom.split(',')\r\n        formdata.DrugsType = formdata.DrugsType.split(',')\r\n        this.$refs.followupEdit.show(flag, data, formdata)\r\n      } else if (flag == 'delete') {\r\n        // 删除\r\n        this.$baseConfirm(\"确定要删除所选项吗？\", '删除', async () => {\r\n          const firstVisitId = data.VisitId\r\n          const res = await pulmonarybadreactionsdelete([firstVisitId])\r\n          let { StatusCode, Message } = res;\r\n          if (StatusCode != 200) {\r\n            return this.$baseMessage(\r\n              Message || '删除失败', 'error'\r\n            )\r\n          }\r\n          this.$baseMessage('删除成功', \"success\")\r\n          this.funPulmonaryVisitlist()\r\n\r\n        },null,\"error\",)\r\n\r\n        this.funPulmonaryVisitlist()\r\n\r\n      }\r\n    },\r\n\r\n    //后此随访\r\n    async followupEdit(flag, firstVisitId, form, hasinfo) {\r\n      if (flag == 'addfollow') {\r\n        let personId = this.copyData[0].PersonId\r\n        let diagnosisId = this.copyData[0].DiagnosisId\r\n        let treatmentPlan = this.copyData[0].TreatmentPlanName\r\n        const res = await pulmonarybadreactionslist({\r\n          ...form,\r\n          PersonId: personId,\r\n          DiagnosisId: diagnosisId,\r\n          TreatmentPlan: treatmentPlan,\r\n        })\r\n        let { StatusCode, Message } = res;\r\n        if (StatusCode != 200) {\r\n          return this.$baseMessage(\r\n            Message || '预约失败', 'error'\r\n          )\r\n        }\r\n        this.$baseMessage('预约成功', \"success\")\r\n        this.funPulmonaryVisitlist()\r\n      } else if (flag == 'Modify') {\r\n\r\n        const res = await pulmonarybadreactionsupdate({ firstVisitId }, hasinfo)\r\n        let { StatusCode, Message } = res;\r\n        if (StatusCode != 200) {\r\n          return this.$baseMessage(\r\n            Message || '修改失败', 'error'\r\n          )\r\n        }\r\n        this.$baseMessage('修改成功', \"success\")\r\n        this.funPulmonaryVisitlist()\r\n      }\r\n      this.funPulmonaryVisitlist()\r\n    },\r\n    // 获取列表\r\n    async funPulmonaryVisitlist() {\r\n      let diagnosisId = this.copyData[0].DiagnosisId\r\n      const res = await PulmonaryVisitlist({ DiagnosisId: diagnosisId })\r\n      let { StatusCode, Message } = res;\r\n      if (StatusCode != 200) {\r\n        return this.$baseMessage(\r\n          Message || '加载失败', 'error'\r\n        )\r\n      }\r\n      this.tableData = res.Response.items\r\n      this.tableData.forEach(item => {\r\n        item.DiagnosisTime = this.copyData[0].DiagnosisTime\r\n        item.ResponsibilityName = this.copyData[0].ResponsibilityName\r\n        item.AdminOrganizationName = this.copyData[0].AdminOrganizationName\r\n      })\r\n    },\r\n    // 2次随访\r\n    async handlerEdit2(flag, data, formdata) {\r\n      //新增\r\n      if (flag == 'addfollow') {\r\n        this.$refs.followupEdit2.show(flag, this.inputData)\r\n      } else if (flag == 'details') {\r\n        // 详情\r\n        const res = await PulmonaryPatientVisitdetails({ patientVisitId: data.VisitId })\r\n        let { StatusCode, Message } = res;\r\n        if (StatusCode != 200) {\r\n          return this.$baseMessage(\r\n            Message || '数据获取失败', 'error'\r\n          )\r\n        }\r\n        formdata = res.Response\r\n        this.$refs.xqfollowEdit2.show(flag, data, formdata)\r\n      } else if (flag == 'Modify') {\r\n        // 修改（先获取详情）\r\n        const res = await PulmonaryPatientVisitdetails({ patientVisitId: data.VisitId })\r\n        let { StatusCode, Message } = res;\r\n        if (StatusCode != 200) {\r\n          return this.$baseMessage(\r\n            Message || '数据获取失败', 'error'\r\n          )\r\n        }\r\n        formdata = res.Response\r\n\t\tformdata.Symptom = formdata.Symptom.split(',')\r\n\t\tformdata.DrugsType = formdata.DrugsType.split(',')\r\n        this.$refs.followupEdit2.show(flag, data, formdata)\r\n      } else if (flag == 'delete') {\r\n        // 删除\r\n        this.$baseConfirm(\"确定要删除所选项吗？\", '删除', async () => {\r\n          const patientVisitId = data.VisitId\r\n          const res = await PulmonaryPatientVisitdelete([patientVisitId])\r\n          let { StatusCode, Message } = res;\r\n          if (StatusCode != 200) {\r\n            return this.$baseMessage(\r\n              Message || '删除失败', 'error'\r\n            )\r\n          }\r\n          this.$baseMessage('删除成功', \"success\")\r\n          this.funPulmonaryVisitlist()\r\n        },null,\"error\",)\r\n\r\n        this.funPulmonaryVisitlist()\r\n\r\n\r\n      }\r\n\r\n    },\r\n\r\n    async followupEdit2(flag, patientVisitId, form, hasinfo) {\r\n      // 新增\r\n      if (flag == 'addfollow') {\r\n        let personId = this.copyData[0].PersonId\r\n        let diagnosisId = this.copyData[0].DiagnosisId\r\n        const res = await PulmonaryPatientVisitlist({\r\n          ...form, PersonId: personId, DiagnosisId: diagnosisId\r\n        })\r\n        let { StatusCode, Message } = res;\r\n\r\n        if (StatusCode != 200) {\r\n          return this.$baseMessage(\r\n            Message || '预约失败', 'error'\r\n          )\r\n        }\r\n        this.$baseMessage('预约成功', \"success\")\r\n        this.funPulmonaryVisitlist()\r\n      } else if (flag == 'Modify') {\r\n\r\n        const res = await PulmonaryPatientVisitupdate({ patientVisitId }, hasinfo)\r\n        let { StatusCode, Message } = res;\r\n        if (StatusCode != 200) {\r\n          return this.$baseMessage(\r\n            Message || '修改失败', 'error'\r\n          )\r\n        }\r\n        this.$baseMessage('修改成功', \"success\")\r\n        this.funPulmonaryVisitlist()\r\n      }\r\n      this.funPulmonaryVisitlist()\r\n\r\n\r\n    },\r\n  },\r\n\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.room2 {\r\n  width: 100%;\r\n  height: 100%;\r\n  // overflow: hidden;\r\n\r\n}\r\n\r\n.heard {\r\n  width: 100%;\r\n  // background:red;\r\n  height: 350px;\r\n  display: flex;\r\n}\r\n\r\n.echartRoom {\r\n  width: 40%;\r\n  height: 100%;\r\n  // float: left;\r\n\r\n}\r\n\r\n.echartRoom>p {\r\n  color: black;\r\n  font-size: 25PX;\r\n  font-weight: 600;\r\n  margin: 15px 0 0 20px;\r\n}\r\n\r\n.calendar {\r\n  width: 60%;\r\n  height: 100%;\r\n  background: rgb(219, 228, 173);\r\n  // float: left;\r\n\r\n}\r\n\r\n.tablebox {\r\n  width: 100%;\r\n  height: 75%;\r\n  float: left;\r\n  margin-top: 10px;\r\n}\r\n\r\n.el-button--medium.is-round {\r\n  margin-top: 30px;\r\n  margin-left: 90%;\r\n}\r\n\r\n.flex_center {\r\n  display: flex;\r\n  margin: 0 auto;\r\n}\r\n</style>"]}]}