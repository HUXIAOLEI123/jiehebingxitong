{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\patientManagement\\patientManagement\\components\\tabComponents\\medicinetab2.vue?vue&type=style&index=0&id=758ca2dc&lang=scss&scoped=true&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\src\\views\\patientManagement\\patientManagement\\components\\tabComponents\\medicinetab2.vue","mtime":1678956412879},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\css-loader\\dist\\cjs.js","mtime":1678931311747},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1678931317953},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\postcss-loader\\src\\index.js","mtime":1678931314216},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1678931310798},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1678931310818},{"path":"C:\\Users\\Administrator\\Desktop\\tuberculosis-fe\\node_modules\\vue-loader\\lib\\index.js","mtime":1678931316857}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5yb29tMiB7DQogIHdpZHRoOiAxMDAlOw0KICBoZWlnaHQ6IDUwMHB4Ow0KICAvLyBvdmVyZmxvdzogaGlkZGVuOw0KICBwb3NpdGlvbjogcmVsYXRpdmU7DQp9DQoNCi5oZWFyZCB7DQogIHdpZHRoOiAxMDAlOw0KICAvLyBiYWNrZ3JvdW5kOnJlZDsNCiAgaGVpZ2h0OiAzMDBweDsNCiAgZGlzcGxheTogZmxleDsNCn0NCg0KLmVjaGFydFJvb20gew0KICB3aWR0aDogNTAlOw0KICBoZWlnaHQ6IDEwMCU7DQoNCiAgLy8gZmxvYXQ6IGxlZnQ7DQp9DQoNCi5lY2hhcnRSb29tID4gcCB7DQogIGNvbG9yOiBibGFjazsNCiAgZm9udC1zaXplOiAyNXB4Ow0KICBmb250LXdlaWdodDogNjAwOw0KICBtYXJnaW46IDE1cHggMCAwIDIwcHg7DQp9DQoNCi5jYWxlbmRhciB7DQogIHdpZHRoOiA1MCU7DQogIGhlaWdodDogMTAwJTsNCiAgYmFja2dyb3VuZDogcmdiKDIxOSwgMjI4LCAxNzMpOw0KICAvLyBmbG9hdDogbGVmdDsNCn0NCg0KLnRhYmxlYm94IHsNCiAgd2lkdGg6IDEwMCU7DQogIGhlaWdodDogNzUlOw0KICBmbG9hdDogbGVmdDsNCiAgbWFyZ2luLXRvcDogMTAwcHg7DQogIC8vIG92ZXJmbG93LXk6IGF1dG87DQp9DQoNCi5hZGRCdG4gew0KICB3aWR0aDogNyU7DQogIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgcmlnaHQ6IDAuNSU7DQogIHRvcDogNzElOw0KfQ0KDQouYWRkQnRuMSB7DQogIHdpZHRoOiA3JTsNCiAgcG9zaXRpb246IGFic29sdXRlOw0KICByaWdodDogOSU7DQogIHRvcDogNzElOw0KfQ0KLmFkZEJ0bjIgew0KICB3aWR0aDogOCU7DQogIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgcG9zaXRpb246IGFic29sdXRlOw0KICByaWdodDogMTglOw0KICB0b3A6IDcxJTsNCn0NCg0KLnNlYXJjaHRpbWUgew0KICBwb3NpdGlvbjogYWJzb2x1dGU7DQogIGxlZnQ6IDAuNSU7DQogIHRvcDogNzElOw0KfQ0K"},{"version":3,"sources":["medicinetab2.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuUA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"medicinetab2.vue","sourceRoot":"src/views/patientManagement/patientManagement/components/tabComponents","sourcesContent":["<template>\r\n  <div class=\"room2\">\r\n    <div class=\"heard\">\r\n      <!-- 图表 -->\r\n      <div class=\"echartRoom\">\r\n        <p>服药完成率</p>\r\n        <MedicinerateEchart :tableData=\"tableData\"></MedicinerateEchart>\r\n      </div>\r\n      <!-- 日历 -->\r\n      <div class=\"calendar\">\r\n        <CalendarTime :diagnosisId=\"DiagnosisId\" :tableData=\"tableData\"></CalendarTime>\r\n      </div>\r\n    </div>\r\n    <div class=\"searchtime\">\r\n      <label style=\"margin-right: 10px\">服药时间</label>\r\n      <el-date-picker\r\n        @change=\"changeSubmitTimes\"\r\n        v-model=\"form.SubmitTimes\"\r\n        unlink-panels\r\n        type=\"datetimerange\"\r\n        align=\"center\"\r\n        value-format=\"yyyy-MM-dd HH:mm:ss\"\r\n      ></el-date-picker>\r\n    </div>\r\n    <div>\r\n      <el-button\r\n        :disabled=\"inputData.IsClosed ? true : false\"\r\n        class=\"exportBtn Btn addBtn2\"\r\n        type=\"success\"\r\n        round\r\n        @click=\"takeMedicineToday\"\r\n      >\r\n        今日服药确认\r\n      </el-button>\r\n      <el-button :disabled=\"inputData.IsClosed ? true : false\" class=\"exportBtn Btn addBtn1\" type=\"success\" round @click=\"handlersure\">\r\n        批量确认\r\n      </el-button>\r\n      <el-button :disabled=\"inputData.IsClosed ? true : false\" class=\"addBtn Btn\" type=\"primary\" round @click=\"clickPulmonaryMedicineList\">\r\n        补录服药\r\n      </el-button>\r\n    </div>\r\n    <!-- 表格 -->\r\n    <div class=\"tablebox\">\r\n      <vxe-table\r\n        auto-resize\r\n        border\r\n        align=\"center\"\r\n        height=\"300\"\r\n        show-header-overflow\r\n        show-overflow\r\n        :row-config=\"{ isHover: true }\"\r\n        :data=\"tableData\"\r\n        @checkbox-change=\"checkboxChange\"\r\n        @checkbox-all=\"checkboxAll\"\r\n      >\r\n        <vxe-column type=\"checkbox\" width=\"60\"></vxe-column>\r\n        <vxe-column field=\"RegisterTime\" title=\"确诊日期\">\r\n          <template slot-scope=\"{ row }\">\r\n            <span>\r\n              {{ row.RegisterTime | parseTime('{y}-{m}-{d}') }}\r\n            </span>\r\n          </template>\r\n        </vxe-column>\r\n        <vxe-column field=\"DataSources\" title=\"数据来源\">\r\n          <template slot-scope=\"{ row }\">\r\n            <span>\r\n              {{ row.DataSources | DataSourceszhuan }}\r\n            </span>\r\n          </template>\r\n        </vxe-column>\r\n        <vxe-column field=\"ResponsibilityName\" title=\"责任医生\"></vxe-column>\r\n        <vxe-column field=\"AdminOrganizationName\" title=\"管理机构\"></vxe-column>\r\n        <vxe-column field=\"SubmitTime\" title=\"服药时间\"></vxe-column>\r\n        <!-- 服药状态判定 -->\r\n        <vxe-column field=\"SubmitConfirm\" title=\"服药状态\">\r\n          <template slot-scope=\"scope\">\r\n            <el-tag type=\"primary\" v-if=\"scope.row.SubmitConfirm == 1\">已确认</el-tag>\r\n            <el-tag type=\"warning\" v-else>未确认</el-tag>\r\n          </template>\r\n        </vxe-column>\r\n        <!-- 播放链接 -->\r\n        <!-- <vxe-column title=\"服药视频\">\r\n          <template #default=\"{ row }\">\r\n          </template>\r\n        </vxe-column> -->\r\n\r\n        <vxe-column title=\"操作\" width=\"200\" fixed=\"right\">\r\n          <template #default=\"{ row }\">\r\n            <div class=\"flex_center\">\r\n              <div v-if=\"row.VideoUrl\" @click=\"watchvideo(row)\">点击查看视频</div>\r\n              <div class=\"Divider\" v-if=\"row.SubmitConfirm !== 1 && row.VideoUrl\"></div>\r\n              <el-link type=\"danger\" @click=\"handlerEdit(row)\" v-if=\"row.SubmitConfirm !== 1\">去确认</el-link>\r\n              <div v-if=\"row.SubmitConfirm == 1 && !row.VideoUrl\" style=\"color: #00c279\">已确认</div>\r\n            </div>\r\n          </template>\r\n        </vxe-column>\r\n      </vxe-table>\r\n      <!-- 分页器 -->\r\n      <div class=\"app-pagination\">\r\n        <el-pagination\r\n          ref=\"elPage\"\r\n          :layout=\"paginationLayout\"\r\n          :total=\"total\"\r\n          :current-page=\"paParams.PageNumber\"\r\n          :page-size=\"paParams.PageSize\"\r\n          @current-change=\"handlerPageChange\"\r\n          @size-change=\"handlerPageSizeChange\"\r\n        ></el-pagination>\r\n      </div>\r\n      <!-- <Medicinetab2Edit ref=\"medicinetab2Edit\"></Medicinetab2Edit> -->\r\n    </div>\r\n    <Watachvideo ref=\"watachvideo\"></Watachvideo>\r\n    <PulmonaryMedicineList ref=\"pulmonarymedicinelist\" @selectSubmit=\"funpulmonarymedicineslist\"></PulmonaryMedicineList>\r\n    <!-- <el-dialog style=\"z-index: 99;\" title=\"视频查看\" :visible.sync=\"flagvideo\" :close-on-click-modal=\"true\" width=\"50%\" @close=\"close\"\r\n\t<video style=\"width: 50%;height: 50%;\" :src=\"videourl\" v-if=\"flagvideo\" poster controls loop ></video>\r\n\t</el-dialog> -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// 图表\r\nimport MedicinerateEchart from './echeatComponents/medicinerateEchart.vue';\r\n// 日历\r\nimport CalendarTime from './echeatComponents/calendarTime.vue';\r\n\r\nimport Watachvideo from './echeatComponents/watachvideo.vue';\r\n//异常服药补录\r\nimport PulmonaryMedicineList from './EditComponents/PulmonaryMedicineList.vue';\r\nimport { pulmonarymedicineslist, pulmonarymedicinessruas, pulmonarymedicinesMedicinesupplement } from '@/api/PulmonaryMedicine.js';\r\nexport default {\r\n  name: 'Medicinetab2',\r\n  components: {\r\n    MedicinerateEchart,\r\n    CalendarTime,\r\n    Watachvideo,\r\n    PulmonaryMedicineList,\r\n  },\r\n  props: ['inputData'],\r\n  data() {\r\n    return {\r\n      form: {\r\n        SubmitTimes: '',\r\n      },\r\n      tableData: [],\r\n      checkRows: [],\r\n      // 列表派发id\r\n      DiagnosisId: '',\r\n      videourl: '', //视频路径\r\n      flagvideo: false, //是否展示视频\r\n      total: 0,\r\n      paParams: {\r\n        PageNumber: 1,\r\n        PageSize: 10,\r\n      },\r\n      toDayTime: '',\r\n    };\r\n  },\r\n  filters: {\r\n    DataSourceszhuan(string) {\r\n      if (string == '1') {\r\n        return '小程序上传';\r\n      } else if (string == '2') {\r\n        return '医生上传';\r\n      } else if (string == '3') {\r\n        return '电子药盒上传';\r\n      } else {\r\n        return '';\r\n      }\r\n    },\r\n  },\r\n  created() {\r\n    this.DiagnosisId = this.inputData.DiagnosisId;\r\n    var datetime = new Date();\r\n    var year = datetime.getFullYear(); //获取完整的年份(4位,如:1970)\r\n    var month = datetime.getMonth() + 1; //获取月份(返回0-11,0代表1月,用的时候记得加上1)\r\n    var date = datetime.getDate(); //获取日(返回1-31)\r\n    var time = 'T02:22:38.209Z';\r\n    // var time = '00:00:00'\r\n    //判断小于等于9月的时候在月份前加一个\"0\"\r\n    if (month <= 9) {\r\n      month = '0' + month;\r\n    }\r\n    //判断小于等于9号的时候在天数前加一个\"0\"\r\n    if (date <= 9) {\r\n      date = '0' + date;\r\n    }\r\n    this.form.SubmitTimes = year + '-' + month + '-' + '' + date + time; //给建档时间默认当前\r\n    this.toDayTime = year + '-' + month + '-' + '' + date + time; //给建档时间默认当前\r\n    this.funpulmonarymedicineslist();\r\n  },\r\n  methods: {\r\n    // 列表\r\n    async funpulmonarymedicineslist() {\r\n      const res = await pulmonarymedicineslist({\r\n        DiagnosisId: this.DiagnosisId,\r\n        SubmitTimes: this.form.SubmitTimes,\r\n        PageNumber: this.paParams.PageNumber,\r\n        PageSize: this.paParams.PageSize,\r\n      });\r\n      let { StatusCode, Message, Response } = res;\r\n\r\n      if (!Response || StatusCode != 200) {\r\n        return this.$baseMessage(Message || '数据获取失败', 'error');\r\n      }\r\n      this.tableData = Response.items;\r\n      let arr = [];\r\n      arr = Response.items;\r\n      arr.forEach(i => {\r\n        if (i.VideoUrl) {\r\n          //引入的后端地址\r\n          let origin = process.env.VUE_APP_BASE;\r\n          // i.VideoUrl = origin + i.VideoUrl.slice(8, i.VideoUrl.length);\r\n          i.VideoUrl = origin + i.VideoUrl;\r\n        }\r\n      });\r\n      this.tableData = arr;\r\n      this.total = Response.TotalCount;\r\n    },\r\n    // 确认\r\n    handlerEdit(data) {\r\n      this.$baseConfirm('确认服药', null, async () => {\r\n        var MedicineId = [];\r\n        MedicineId.push(data.MedicineId);\r\n        const res = await pulmonarymedicinessruas(MedicineId);\r\n        let { StatusCode, Message } = res;\r\n        if (StatusCode != 200) {\r\n          return this.$baseMessage(Message || '确认失败', 'error');\r\n        }\r\n        this.funpulmonarymedicineslist();\r\n        this.$baseMessage('确认成功', 'success');\r\n      });\r\n    },\r\n    //今日服药\r\n    async takeMedicineToday() {\r\n      await pulmonarymedicinesMedicinesupplement({\r\n        diagnosisId: this.DiagnosisId,\r\n        Arr: [this.toDayTime],\r\n      });\r\n      this.$baseMessage('服药成功', 'success');\r\n    },\r\n    //选择服药时间\r\n    changeSubmitTimes(value) {\r\n      this.form.SubmitTimes = value;\r\n      this.funpulmonarymedicineslist();\r\n    },\r\n    watchvideo(e) {\r\n      this.videourl = e.VideoUrl;\r\n      // this.flagvideo = true;\r\n      this.$refs.watachvideo.show(this.videourl);\r\n    },\r\n    // 复选框事件\r\n    checkboxChange({ records }) {\r\n      this.checkRows = records;\r\n    },\r\n    // 全选按钮事件\r\n    checkboxAll({ records }) {\r\n      this.checkRows = records;\r\n    },\r\n    // 异常服药补录列表\r\n    clickPulmonaryMedicineList() {\r\n      var param = {\r\n        title: '服药记录',\r\n        visible: true,\r\n        DiagnosisId: this.DiagnosisId,\r\n        num: 1,\r\n        SubmitConfirm: 0,\r\n      };\r\n      this.$refs.pulmonarymedicinelist.getDetail(param);\r\n    },\r\n    // 批量确认\r\n    handlersure() {\r\n      let len = this.checkRows.length;\r\n      if (!len) {\r\n        return this.$baseMessage('至少选择一项！', 'error');\r\n      }\r\n      this.$baseConfirm(\r\n        '确定要服药选中的数据吗？',\r\n        null,\r\n        // 将选中的数据添加属性删除\r\n        async () => {\r\n          let storeId = this.checkRows.map(item => {\r\n            return item.MedicineId;\r\n          });\r\n          //派发请求\r\n          const res = await pulmonarymedicinessruas(storeId);\r\n          this.funpulmonarymedicineslist();\r\n          this.$baseMessage('确认成功', 'success');\r\n        }\r\n      );\r\n    },\r\n    // 分页当前页变化回调\r\n    handlerPageChange(PageNumber) {\r\n      this.paParams.PageNumber = PageNumber;\r\n      this.funpulmonarymedicineslist();\r\n    },\r\n    // 分页每页条数变化回调\r\n    handlerPageSizeChange(PageSize) {\r\n      this.paParams.PageSize = PageSize;\r\n      this.funpulmonarymedicineslist();\r\n    },\r\n    //取消\r\n    close() {\r\n      this.flagvideo = false;\r\n    },\r\n  },\r\n  watch: {\r\n    inputData: function (val) {\r\n      this.DiagnosisId = this.inputData.DiagnosisId;\r\n      var datetime = new Date();\r\n      var year = datetime.getFullYear(); //获取完整的年份(4位,如:1970)\r\n      var month = datetime.getMonth() + 1; //获取月份(返回0-11,0代表1月,用的时候记得加上1)\r\n      var date = datetime.getDate(); //获取日(返回1-31)\r\n      //判断小于等于9月的时候在月份前加一个\"0\"\r\n      if (month <= 9) {\r\n        month = '0' + month;\r\n      }\r\n      //判断小于等于9号的时候在天数前加一个\"0\"\r\n      if (date <= 9) {\r\n        date = '0' + date;\r\n      }\r\n      this.form.SubmitTimes = year + '-' + month + '-' + date; //给建档时间默认当前\r\n      this.funpulmonarymedicineslist();\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.room2 {\r\n  width: 100%;\r\n  height: 500px;\r\n  // overflow: hidden;\r\n  position: relative;\r\n}\r\n\r\n.heard {\r\n  width: 100%;\r\n  // background:red;\r\n  height: 300px;\r\n  display: flex;\r\n}\r\n\r\n.echartRoom {\r\n  width: 50%;\r\n  height: 100%;\r\n\r\n  // float: left;\r\n}\r\n\r\n.echartRoom > p {\r\n  color: black;\r\n  font-size: 25px;\r\n  font-weight: 600;\r\n  margin: 15px 0 0 20px;\r\n}\r\n\r\n.calendar {\r\n  width: 50%;\r\n  height: 100%;\r\n  background: rgb(219, 228, 173);\r\n  // float: left;\r\n}\r\n\r\n.tablebox {\r\n  width: 100%;\r\n  height: 75%;\r\n  float: left;\r\n  margin-top: 100px;\r\n  // overflow-y: auto;\r\n}\r\n\r\n.addBtn {\r\n  width: 7%;\r\n  position: absolute;\r\n  right: 0.5%;\r\n  top: 71%;\r\n}\r\n\r\n.addBtn1 {\r\n  width: 7%;\r\n  position: absolute;\r\n  right: 9%;\r\n  top: 71%;\r\n}\r\n.addBtn2 {\r\n  width: 8%;\r\n  text-align: center;\r\n  position: absolute;\r\n  right: 18%;\r\n  top: 71%;\r\n}\r\n\r\n.searchtime {\r\n  position: absolute;\r\n  left: 0.5%;\r\n  top: 71%;\r\n}\r\n</style>\r\n"]}]}